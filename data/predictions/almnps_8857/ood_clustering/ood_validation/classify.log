Saved arguments to data/predictions/almnps_8857/ood_clustering/ood_validation/args.json.
Out of domain clustering of entities with domain-specific unique entities created and saved to: data/predictions/ood_clustering_data/8857/
loading projection weights from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz
KeyedVectors lifecycle event {'msg': 'loaded (3000000, 300) matrix of type float32 from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz', 'binary': True, 'encoding': 'utf8', 'datetime': '2023-05-11T01:10:13.503736', 'gensim': '4.3.0', 'python': '3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) \n[GCC 11.3.0]', 'platform': 'Linux-5.15.90.1-microsoft-standard-WSL2-x86_64-with-glibc2.31', 'event': 'load_word2vec_format'}
Saved category mapping to data/predictions/almnps_8857/ood_clustering/ood_validation/entity2category_mapping.json.
Loaded category mapping: ood_clustering.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a5bdb0eb0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a5bdb0220> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4078, Macro-f1: 0.2351, Weighted-f1: 0.3317, Loss: 1.9746
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5043, Macro-f1: 0.3310, Weighted-f1: 0.4519, Loss: 1.6974
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.6974 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7335, Macro-f1: 0.5888, Weighted-f1: 0.7053, Loss: 0.9996
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5295, Macro-f1: 0.3677, Weighted-f1: 0.4871, Loss: 1.5345
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5345 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8582, Macro-f1: 0.7671, Weighted-f1: 0.8462, Loss: 0.5968
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5436, Macro-f1: 0.3812, Weighted-f1: 0.5016, Loss: 1.4696
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4696 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9242, Macro-f1: 0.8731, Weighted-f1: 0.9168, Loss: 0.3663
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5554, Macro-f1: 0.3966, Weighted-f1: 0.5184, Loss: 1.4389
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4389 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9673, Macro-f1: 0.9356, Weighted-f1: 0.9644, Loss: 0.2239
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5634, Macro-f1: 0.4075, Weighted-f1: 0.5292, Loss: 1.4676
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9834, Macro-f1: 0.9671, Weighted-f1: 0.9801, Loss: 0.1415
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5698, Macro-f1: 0.4147, Weighted-f1: 0.5373, Loss: 1.5059
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9912, Macro-f1: 0.9776, Weighted-f1: 0.9900, Loss: 0.0837
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5755, Macro-f1: 0.4210, Weighted-f1: 0.5447, Loss: 1.5736
Saved models from epoch 7 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4389 loss). Early stop.
OOD training completed for test topic ai after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a644d62e0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a5bdb0ee0> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3987, Macro-f1: 0.2315, Weighted-f1: 0.3268, Loss: 2.0257
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4993, Macro-f1: 0.3474, Weighted-f1: 0.4616, Loss: 1.7078
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.7078 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7049, Macro-f1: 0.5590, Weighted-f1: 0.6752, Loss: 1.0714
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5162, Macro-f1: 0.3682, Weighted-f1: 0.4844, Loss: 1.5321
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.5321 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8411, Macro-f1: 0.7470, Weighted-f1: 0.8242, Loss: 0.6309
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5255, Macro-f1: 0.3766, Weighted-f1: 0.4957, Loss: 1.5013
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.5013 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9136, Macro-f1: 0.8516, Weighted-f1: 0.9069, Loss: 0.3997
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5370, Macro-f1: 0.3890, Weighted-f1: 0.5094, Loss: 1.4476
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4476 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9616, Macro-f1: 0.9321, Weighted-f1: 0.9602, Loss: 0.2342
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5442, Macro-f1: 0.3975, Weighted-f1: 0.5181, Loss: 1.5127
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9764, Macro-f1: 0.9582, Weighted-f1: 0.9729, Loss: 0.1505
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5497, Macro-f1: 0.4045, Weighted-f1: 0.5248, Loss: 1.5421
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9909, Macro-f1: 0.9858, Weighted-f1: 0.9901, Loss: 0.1027
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5555, Macro-f1: 0.4107, Weighted-f1: 0.5323, Loss: 1.5611
Saved models from epoch 7 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4476 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a6cd4f6a0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a644d67c0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3574, Macro-f1: 0.1992, Weighted-f1: 0.2701, Loss: 2.1695
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4620, Macro-f1: 0.3107, Weighted-f1: 0.4237, Loss: 1.8525
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.8525 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6738, Macro-f1: 0.5434, Weighted-f1: 0.6436, Loss: 1.2004
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4793, Macro-f1: 0.3300, Weighted-f1: 0.4425, Loss: 1.6636
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.6636 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8095, Macro-f1: 0.6973, Weighted-f1: 0.7898, Loss: 0.7320
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4890, Macro-f1: 0.3425, Weighted-f1: 0.4538, Loss: 1.6240
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.6240 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8913, Macro-f1: 0.8285, Weighted-f1: 0.8831, Loss: 0.4629
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5001, Macro-f1: 0.3566, Weighted-f1: 0.4696, Loss: 1.5624
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5624 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9470, Macro-f1: 0.9091, Weighted-f1: 0.9412, Loss: 0.2881
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5096, Macro-f1: 0.3679, Weighted-f1: 0.4820, Loss: 1.5991
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9755, Macro-f1: 0.9557, Weighted-f1: 0.9738, Loss: 0.1780
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5173, Macro-f1: 0.3774, Weighted-f1: 0.4931, Loss: 1.6222
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9865, Macro-f1: 0.9769, Weighted-f1: 0.9855, Loss: 0.1172
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5226, Macro-f1: 0.3848, Weighted-f1: 0.4998, Loss: 1.7587
Saved models from epoch 7 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5624 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a75318d30> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a5bdf1670> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3952, Macro-f1: 0.2480, Weighted-f1: 0.3376, Loss: 2.0003
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4851, Macro-f1: 0.3403, Weighted-f1: 0.4510, Loss: 1.7522
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.7522 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7014, Macro-f1: 0.5768, Weighted-f1: 0.6710, Loss: 1.0849
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5133, Macro-f1: 0.3653, Weighted-f1: 0.4776, Loss: 1.5409
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.5409 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8267, Macro-f1: 0.7426, Weighted-f1: 0.8109, Loss: 0.7005
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5303, Macro-f1: 0.3824, Weighted-f1: 0.4955, Loss: 1.4907
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4907 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8986, Macro-f1: 0.8240, Weighted-f1: 0.8919, Loss: 0.4424
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5430, Macro-f1: 0.3949, Weighted-f1: 0.5099, Loss: 1.4553
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4553 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9452, Macro-f1: 0.9037, Weighted-f1: 0.9413, Loss: 0.2923
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5509, Macro-f1: 0.4023, Weighted-f1: 0.5189, Loss: 1.4996
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9686, Macro-f1: 0.9469, Weighted-f1: 0.9649, Loss: 0.1997
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5580, Macro-f1: 0.4099, Weighted-f1: 0.5271, Loss: 1.5708
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9876, Macro-f1: 0.9807, Weighted-f1: 0.9868, Loss: 0.1248
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5643, Macro-f1: 0.4175, Weighted-f1: 0.5345, Loss: 1.5515
Saved models from epoch 7 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.4553 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a6cd13ee0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a752f32b0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3769, Macro-f1: 0.2320, Weighted-f1: 0.3214, Loss: 2.1271
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5009, Macro-f1: 0.3451, Weighted-f1: 0.4595, Loss: 1.7679
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.7679 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6868, Macro-f1: 0.5481, Weighted-f1: 0.6577, Loss: 1.1361
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5246, Macro-f1: 0.3666, Weighted-f1: 0.4884, Loss: 1.5130
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.5130 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8332, Macro-f1: 0.7367, Weighted-f1: 0.8152, Loss: 0.6978
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5399, Macro-f1: 0.3838, Weighted-f1: 0.5063, Loss: 1.4400
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4400 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9031, Macro-f1: 0.8423, Weighted-f1: 0.8961, Loss: 0.4495
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5514, Macro-f1: 0.3952, Weighted-f1: 0.5201, Loss: 1.4239
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4239 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9397, Macro-f1: 0.8942, Weighted-f1: 0.9345, Loss: 0.2948
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5593, Macro-f1: 0.4011, Weighted-f1: 0.5280, Loss: 1.4052
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4052 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9735, Macro-f1: 0.9461, Weighted-f1: 0.9724, Loss: 0.1843
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5660, Macro-f1: 0.4087, Weighted-f1: 0.5360, Loss: 1.4192
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9870, Macro-f1: 0.9776, Weighted-f1: 0.9863, Loss: 0.1193
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5717, Macro-f1: 0.4134, Weighted-f1: 0.5429, Loss: 1.4176
Saved models from epoch 7 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9944, Macro-f1: 0.9900, Weighted-f1: 0.9936, Loss: 0.0844
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5761, Macro-f1: 0.4176, Weighted-f1: 0.5478, Loss: 1.4498
Saved models from epoch 8 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.4052 loss). Early stop.
OOD training completed for test topic politics after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a64489d30> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f3a645bc3d0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data.
Read data from folder data/predictions/ood_clustering_data/8857/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4114, Macro-f1: 0.2436, Weighted-f1: 0.3432, Loss: 2.0120
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5180, Macro-f1: 0.3590, Weighted-f1: 0.4736, Loss: 1.6140
Saved models from epoch 1 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.6140 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7036, Macro-f1: 0.5595, Weighted-f1: 0.6756, Loss: 1.0433
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5342, Macro-f1: 0.3789, Weighted-f1: 0.4938, Loss: 1.4559
Saved models from epoch 2 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.4559 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8364, Macro-f1: 0.7374, Weighted-f1: 0.8220, Loss: 0.6312
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5499, Macro-f1: 0.3954, Weighted-f1: 0.5143, Loss: 1.3969
Saved models from epoch 3 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.3969 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9130, Macro-f1: 0.8475, Weighted-f1: 0.9052, Loss: 0.3862
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5608, Macro-f1: 0.4070, Weighted-f1: 0.5270, Loss: 1.4516
Saved models from epoch 4 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9522, Macro-f1: 0.9190, Weighted-f1: 0.9488, Loss: 0.2478
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5695, Macro-f1: 0.4173, Weighted-f1: 0.5384, Loss: 1.4242
Saved models from epoch 5 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9823, Macro-f1: 0.9662, Weighted-f1: 0.9823, Loss: 0.1496
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5745, Macro-f1: 0.4239, Weighted-f1: 0.5452, Loss: 1.4845
Saved models from epoch 6 to 'data/predictions/almnps_8857/ood_clustering/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3969 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		ood_clustering
