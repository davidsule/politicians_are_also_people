Saved arguments to data/predictions/almnps_8878/no_mapping/ood/args.json.
Saved category mapping to data/predictions/almnps_8878/no_mapping/ood/mapping.json.
Loaded category mapping: no_mapping.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa658910> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa658f10> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3899, Macro-f1: 0.2046, Weighted-f1: 0.3074, Loss: 2.0922
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4942, Macro-f1: 0.3072, Weighted-f1: 0.4268, Loss: 1.7896
Saved models from epoch 1 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
Saved model with best loss 1.7896 to 'data/predictions/almnps_8878/no_mapping/ood/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7095, Macro-f1: 0.5472, Weighted-f1: 0.6707, Loss: 1.1294
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5282, Macro-f1: 0.3512, Weighted-f1: 0.4731, Loss: 1.5273
Saved models from epoch 2 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
Saved model with best loss 1.5273 to 'data/predictions/almnps_8878/no_mapping/ood/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8289, Macro-f1: 0.7181, Weighted-f1: 0.8066, Loss: 0.6835
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5481, Macro-f1: 0.3751, Weighted-f1: 0.4987, Loss: 1.4296
Saved models from epoch 3 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
Saved model with best loss 1.4296 to 'data/predictions/almnps_8878/no_mapping/ood/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8981, Macro-f1: 0.8212, Weighted-f1: 0.8860, Loss: 0.4305
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5613, Macro-f1: 0.3924, Weighted-f1: 0.5178, Loss: 1.4495
Saved models from epoch 4 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9483, Macro-f1: 0.9051, Weighted-f1: 0.9445, Loss: 0.2821
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5688, Macro-f1: 0.4009, Weighted-f1: 0.5274, Loss: 1.4389
Saved models from epoch 5 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9764, Macro-f1: 0.9483, Weighted-f1: 0.9737, Loss: 0.1674
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5755, Macro-f1: 0.4083, Weighted-f1: 0.5365, Loss: 1.5101
Saved models from epoch 6 to 'data/predictions/almnps_8878/no_mapping/ood/ai/newest.pt'.
No improvement since 3 epochs (1.4296 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8ac6dc670> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa658d90> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3680, Macro-f1: 0.2078, Weighted-f1: 0.2968, Loss: 2.1306
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5000, Macro-f1: 0.3383, Weighted-f1: 0.4541, Loss: 1.7715
Saved models from epoch 1 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
Saved model with best loss 1.7715 to 'data/predictions/almnps_8878/no_mapping/ood/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7017, Macro-f1: 0.5514, Weighted-f1: 0.6697, Loss: 1.1601
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5186, Macro-f1: 0.3574, Weighted-f1: 0.4794, Loss: 1.5682
Saved models from epoch 2 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
Saved model with best loss 1.5682 to 'data/predictions/almnps_8878/no_mapping/ood/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8257, Macro-f1: 0.7328, Weighted-f1: 0.8113, Loss: 0.7192
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5303, Macro-f1: 0.3754, Weighted-f1: 0.4953, Loss: 1.4843
Saved models from epoch 3 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
Saved model with best loss 1.4843 to 'data/predictions/almnps_8878/no_mapping/ood/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9070, Macro-f1: 0.8484, Weighted-f1: 0.8977, Loss: 0.4474
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5402, Macro-f1: 0.3831, Weighted-f1: 0.5083, Loss: 1.4753
Saved models from epoch 4 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
Saved model with best loss 1.4753 to 'data/predictions/almnps_8878/no_mapping/ood/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9510, Macro-f1: 0.9161, Weighted-f1: 0.9469, Loss: 0.2817
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5478, Macro-f1: 0.3923, Weighted-f1: 0.5180, Loss: 1.4449
Saved models from epoch 5 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
Saved model with best loss 1.4449 to 'data/predictions/almnps_8878/no_mapping/ood/literature/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9807, Macro-f1: 0.9690, Weighted-f1: 0.9807, Loss: 0.1732
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5533, Macro-f1: 0.3976, Weighted-f1: 0.5247, Loss: 1.5231
Saved models from epoch 6 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9915, Macro-f1: 0.9800, Weighted-f1: 0.9914, Loss: 0.1160
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5585, Macro-f1: 0.4024, Weighted-f1: 0.5308, Loss: 1.4812
Saved models from epoch 7 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9958, Macro-f1: 0.9877, Weighted-f1: 0.9956, Loss: 0.0749
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5620, Macro-f1: 0.4069, Weighted-f1: 0.5352, Loss: 1.5805
Saved models from epoch 8 to 'data/predictions/almnps_8878/no_mapping/ood/literature/newest.pt'.
No improvement since 3 epochs (1.4449 loss). Early stop.
OOD training completed for test topic literature after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa378790> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8ac109cd0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3249, Macro-f1: 0.1863, Weighted-f1: 0.2623, Loss: 2.2305
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4468, Macro-f1: 0.2879, Weighted-f1: 0.3971, Loss: 1.9557
Saved models from epoch 1 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
Saved model with best loss 1.9557 to 'data/predictions/almnps_8878/no_mapping/ood/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6478, Macro-f1: 0.4902, Weighted-f1: 0.6087, Loss: 1.3177
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4675, Macro-f1: 0.3091, Weighted-f1: 0.4216, Loss: 1.7304
Saved models from epoch 2 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
Saved model with best loss 1.7304 to 'data/predictions/almnps_8878/no_mapping/ood/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.7773, Macro-f1: 0.6608, Weighted-f1: 0.7550, Loss: 0.8521
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4825, Macro-f1: 0.3242, Weighted-f1: 0.4401, Loss: 1.6129
Saved models from epoch 3 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
Saved model with best loss 1.6129 to 'data/predictions/almnps_8878/no_mapping/ood/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8709, Macro-f1: 0.7866, Weighted-f1: 0.8606, Loss: 0.5478
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4964, Macro-f1: 0.3407, Weighted-f1: 0.4569, Loss: 1.5398
Saved models from epoch 4 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
Saved model with best loss 1.5398 to 'data/predictions/almnps_8878/no_mapping/ood/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9410, Macro-f1: 0.8962, Weighted-f1: 0.9364, Loss: 0.3495
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5055, Macro-f1: 0.3528, Weighted-f1: 0.4694, Loss: 1.5832
Saved models from epoch 5 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9667, Macro-f1: 0.9323, Weighted-f1: 0.9643, Loss: 0.2311
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5116, Macro-f1: 0.3607, Weighted-f1: 0.4772, Loss: 1.6423
Saved models from epoch 6 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9883, Macro-f1: 0.9719, Weighted-f1: 0.9881, Loss: 0.1476
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5160, Macro-f1: 0.3661, Weighted-f1: 0.4832, Loss: 1.6813
Saved models from epoch 7 to 'data/predictions/almnps_8878/no_mapping/ood/music/newest.pt'.
No improvement since 3 epochs (1.5398 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa340130> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa4353a0> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3722, Macro-f1: 0.2185, Weighted-f1: 0.3110, Loss: 2.1226
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4963, Macro-f1: 0.3321, Weighted-f1: 0.4482, Loss: 1.7774
Saved models from epoch 1 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
Saved model with best loss 1.7774 to 'data/predictions/almnps_8878/no_mapping/ood/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6944, Macro-f1: 0.5426, Weighted-f1: 0.6636, Loss: 1.1003
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5312, Macro-f1: 0.3710, Weighted-f1: 0.4917, Loss: 1.4797
Saved models from epoch 2 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
Saved model with best loss 1.4797 to 'data/predictions/almnps_8878/no_mapping/ood/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8456, Macro-f1: 0.7489, Weighted-f1: 0.8331, Loss: 0.6454
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5450, Macro-f1: 0.3851, Weighted-f1: 0.5064, Loss: 1.4461
Saved models from epoch 3 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
Saved model with best loss 1.4461 to 'data/predictions/almnps_8878/no_mapping/ood/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9216, Macro-f1: 0.8682, Weighted-f1: 0.9139, Loss: 0.3868
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5567, Macro-f1: 0.3989, Weighted-f1: 0.5212, Loss: 1.4331
Saved models from epoch 4 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
Saved model with best loss 1.4331 to 'data/predictions/almnps_8878/no_mapping/ood/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9604, Macro-f1: 0.9353, Weighted-f1: 0.9568, Loss: 0.2362
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5657, Macro-f1: 0.4081, Weighted-f1: 0.5323, Loss: 1.4479
Saved models from epoch 5 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9825, Macro-f1: 0.9699, Weighted-f1: 0.9810, Loss: 0.1437
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5726, Macro-f1: 0.4162, Weighted-f1: 0.5418, Loss: 1.4922
Saved models from epoch 6 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9905, Macro-f1: 0.9850, Weighted-f1: 0.9896, Loss: 0.0961
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5780, Macro-f1: 0.4223, Weighted-f1: 0.5479, Loss: 1.5292
Saved models from epoch 7 to 'data/predictions/almnps_8878/no_mapping/ood/news/newest.pt'.
No improvement since 3 epochs (1.4331 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe89170aa60> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fe8aa325ee0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
