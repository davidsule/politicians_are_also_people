Saved arguments to data/predictions\almnps_8878\embedding\ood_validation\args.json.
loading projection weights from C:\Users\petko/gensim-data\word2vec-google-news-300\word2vec-google-news-300.gz
KeyedVectors lifecycle event {'msg': 'loaded (3000000, 300) matrix of type float32 from C:\\Users\\petko/gensim-data\\word2vec-google-news-300\\word2vec-google-news-300.gz', 'binary': True, 'encoding': 'utf8', 'datetime': '2023-05-15T13:48:17.123932', 'gensim': '4.3.0', 'python': '3.9.16 (main, Mar  8 2023, 10:39:24) [MSC v.1916 64 bit (AMD64)]', 'platform': 'Windows-10-10.0.22000-SP0', 'event': 'load_word2vec_format'}
Saved category mapping to data/predictions\almnps_8878\embedding\ood_validation\entity2category_mapping.json.
Loaded category mapping: embedding.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500D124160> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500D1248B0> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4006, Macro-f1: 0.2126, Weighted-f1: 0.3248, Loss: 2.0636
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4867, Macro-f1: 0.3072, Weighted-f1: 0.4224, Loss: 1.7835
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
Saved model with best loss 1.7835 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7018, Macro-f1: 0.5488, Weighted-f1: 0.6626, Loss: 1.0965
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5234, Macro-f1: 0.3427, Weighted-f1: 0.4713, Loss: 1.5022
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
Saved model with best loss 1.5022 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8422, Macro-f1: 0.7230, Weighted-f1: 0.8236, Loss: 0.6440
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5389, Macro-f1: 0.3615, Weighted-f1: 0.4897, Loss: 1.4781
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
Saved model with best loss 1.4781 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9073, Macro-f1: 0.8222, Weighted-f1: 0.8972, Loss: 0.4054
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5521, Macro-f1: 0.3784, Weighted-f1: 0.5062, Loss: 1.4063
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
Saved model with best loss 1.4063 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9539, Macro-f1: 0.9146, Weighted-f1: 0.9508, Loss: 0.2455
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5598, Macro-f1: 0.3889, Weighted-f1: 0.5162, Loss: 1.4390
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9682, Macro-f1: 0.9435, Weighted-f1: 0.9665, Loss: 0.1672
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5670, Macro-f1: 0.3987, Weighted-f1: 0.5251, Loss: 1.5041
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9851, Macro-f1: 0.9708, Weighted-f1: 0.9846, Loss: 0.1106
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5711, Macro-f1: 0.4044, Weighted-f1: 0.5299, Loss: 1.5916
Saved models from epoch 7 to 'data/predictions\almnps_8878\embedding\ood_validation\ai\newest.pt'.
No improvement since 3 epochs (1.4063 loss). Early stop.
OOD training completed for test topic ai after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500CCDFA00> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500D124D90> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3639, Macro-f1: 0.2078, Weighted-f1: 0.2927, Loss: 2.1307
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4871, Macro-f1: 0.3350, Weighted-f1: 0.4445, Loss: 1.8119
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
Saved model with best loss 1.8119 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6954, Macro-f1: 0.5568, Weighted-f1: 0.6650, Loss: 1.1599
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5007, Macro-f1: 0.3468, Weighted-f1: 0.4622, Loss: 1.6014
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
Saved model with best loss 1.6014 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8215, Macro-f1: 0.7264, Weighted-f1: 0.8074, Loss: 0.7081
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5135, Macro-f1: 0.3621, Weighted-f1: 0.4802, Loss: 1.5327
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
Saved model with best loss 1.5327 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9033, Macro-f1: 0.8304, Weighted-f1: 0.8938, Loss: 0.4579
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5240, Macro-f1: 0.3716, Weighted-f1: 0.4920, Loss: 1.4887
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4887 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9446, Macro-f1: 0.8941, Weighted-f1: 0.9422, Loss: 0.2926
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5324, Macro-f1: 0.3821, Weighted-f1: 0.5026, Loss: 1.5018
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9671, Macro-f1: 0.9423, Weighted-f1: 0.9635, Loss: 0.1913
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5383, Macro-f1: 0.3883, Weighted-f1: 0.5098, Loss: 1.5232
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9878, Macro-f1: 0.9780, Weighted-f1: 0.9863, Loss: 0.1161
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5443, Macro-f1: 0.3957, Weighted-f1: 0.5173, Loss: 1.5627
Saved models from epoch 7 to 'data/predictions\almnps_8878\embedding\ood_validation\literature\newest.pt'.
No improvement since 3 epochs (1.4887 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500B986220> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500CCDAD60> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3418, Macro-f1: 0.1790, Weighted-f1: 0.2641, Loss: 2.2082
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4372, Macro-f1: 0.2775, Weighted-f1: 0.3842, Loss: 1.9554
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
Saved model with best loss 1.9554 to 'data/predictions\almnps_8878\embedding\ood_validation\music\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6676, Macro-f1: 0.5341, Weighted-f1: 0.6365, Loss: 1.2814
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4663, Macro-f1: 0.3077, Weighted-f1: 0.4226, Loss: 1.7089
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
Saved model with best loss 1.7089 to 'data/predictions\almnps_8878\embedding\ood_validation\music\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.7974, Macro-f1: 0.6973, Weighted-f1: 0.7758, Loss: 0.8086
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4827, Macro-f1: 0.3279, Weighted-f1: 0.4451, Loss: 1.6220
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
Saved model with best loss 1.6220 to 'data/predictions\almnps_8878\embedding\ood_validation\music\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8841, Macro-f1: 0.8031, Weighted-f1: 0.8707, Loss: 0.5165
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4937, Macro-f1: 0.3403, Weighted-f1: 0.4574, Loss: 1.5812
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
Saved model with best loss 1.5812 to 'data/predictions\almnps_8878\embedding\ood_validation\music\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9338, Macro-f1: 0.8806, Weighted-f1: 0.9293, Loss: 0.3376
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5020, Macro-f1: 0.3516, Weighted-f1: 0.4690, Loss: 1.5844
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9684, Macro-f1: 0.9453, Weighted-f1: 0.9663, Loss: 0.2191
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5103, Macro-f1: 0.3620, Weighted-f1: 0.4796, Loss: 1.5745
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
Saved model with best loss 1.5745 to 'data/predictions\almnps_8878\embedding\ood_validation\music\best.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9866, Macro-f1: 0.9768, Weighted-f1: 0.9853, Loss: 0.1394
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5166, Macro-f1: 0.3701, Weighted-f1: 0.4873, Loss: 1.6338
Saved models from epoch 7 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9972, Macro-f1: 0.9939, Weighted-f1: 0.9970, Loss: 0.0897
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5211, Macro-f1: 0.3753, Weighted-f1: 0.4925, Loss: 1.6908
Saved models from epoch 8 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
[Epoch 9/50] Train completed with Micro-f1: 0.9972, Macro-f1: 0.9945, Weighted-f1: 0.9973, Loss: 0.0671
[Epoch 9/50] Evaluation completed with Micro-f1: 0.5252, Macro-f1: 0.3803, Weighted-f1: 0.4969, Loss: 1.7272
Saved models from epoch 9 to 'data/predictions\almnps_8878\embedding\ood_validation\music\newest.pt'.
No improvement since 3 epochs (1.5745 loss). Early stop.
OOD training completed for test topic music after 9 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500B923280> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500B9D4700> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4010, Macro-f1: 0.2410, Weighted-f1: 0.3332, Loss: 2.0467
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5092, Macro-f1: 0.3468, Weighted-f1: 0.4716, Loss: 1.6904
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
Saved model with best loss 1.6904 to 'data/predictions\almnps_8878\embedding\ood_validation\news\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7086, Macro-f1: 0.5695, Weighted-f1: 0.6819, Loss: 1.0726
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5314, Macro-f1: 0.3696, Weighted-f1: 0.4944, Loss: 1.5161
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
Saved model with best loss 1.5161 to 'data/predictions\almnps_8878\embedding\ood_validation\news\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8379, Macro-f1: 0.7426, Weighted-f1: 0.8262, Loss: 0.6508
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5439, Macro-f1: 0.3860, Weighted-f1: 0.5083, Loss: 1.5354
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9040, Macro-f1: 0.8340, Weighted-f1: 0.8951, Loss: 0.4092
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5553, Macro-f1: 0.3996, Weighted-f1: 0.5232, Loss: 1.4767
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
Saved model with best loss 1.4767 to 'data/predictions\almnps_8878\embedding\ood_validation\news\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9536, Macro-f1: 0.9097, Weighted-f1: 0.9517, Loss: 0.2556
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5630, Macro-f1: 0.4111, Weighted-f1: 0.5352, Loss: 1.5511
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9792, Macro-f1: 0.9644, Weighted-f1: 0.9770, Loss: 0.1584
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5688, Macro-f1: 0.4186, Weighted-f1: 0.5432, Loss: 1.6456
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9867, Macro-f1: 0.9724, Weighted-f1: 0.9854, Loss: 0.1014
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5732, Macro-f1: 0.4235, Weighted-f1: 0.5484, Loss: 1.7068
Saved models from epoch 7 to 'data/predictions\almnps_8878\embedding\ood_validation\news\newest.pt'.
No improvement since 3 epochs (1.4767 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500D0E8400> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500B92F520> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3648, Macro-f1: 0.2076, Weighted-f1: 0.3000, Loss: 2.1653
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4519, Macro-f1: 0.2783, Weighted-f1: 0.4007, Loss: 1.8472
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
Saved model with best loss 1.8472 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6576, Macro-f1: 0.4960, Weighted-f1: 0.6183, Loss: 1.2444
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4871, Macro-f1: 0.3142, Weighted-f1: 0.4404, Loss: 1.5863
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
Saved model with best loss 1.5863 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8062, Macro-f1: 0.6936, Weighted-f1: 0.7853, Loss: 0.7965
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5084, Macro-f1: 0.3393, Weighted-f1: 0.4672, Loss: 1.4610
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
Saved model with best loss 1.4610 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8901, Macro-f1: 0.8105, Weighted-f1: 0.8800, Loss: 0.5192
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5229, Macro-f1: 0.3554, Weighted-f1: 0.4856, Loss: 1.4100
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
Saved model with best loss 1.4100 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9321, Macro-f1: 0.8807, Weighted-f1: 0.9272, Loss: 0.3405
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5341, Macro-f1: 0.3676, Weighted-f1: 0.4987, Loss: 1.3964
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3964 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9671, Macro-f1: 0.9320, Weighted-f1: 0.9649, Loss: 0.2215
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5428, Macro-f1: 0.3761, Weighted-f1: 0.5082, Loss: 1.4110
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9868, Macro-f1: 0.9685, Weighted-f1: 0.9871, Loss: 0.1442
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5501, Macro-f1: 0.3837, Weighted-f1: 0.5160, Loss: 1.4478
Saved models from epoch 7 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9916, Macro-f1: 0.9802, Weighted-f1: 0.9900, Loss: 0.1030
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5563, Macro-f1: 0.3914, Weighted-f1: 0.5237, Loss: 1.4573
Saved models from epoch 8 to 'data/predictions\almnps_8878\embedding\ood_validation\politics\newest.pt'.
No improvement since 3 epochs (1.3964 loss). Early stop.
OOD training completed for test topic politics after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500B5C00D0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001500CE49BB0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3654, Macro-f1: 0.1960, Weighted-f1: 0.2888, Loss: 2.1103
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5105, Macro-f1: 0.3370, Weighted-f1: 0.4599, Loss: 1.7314
Saved models from epoch 1 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
Saved model with best loss 1.7314 to 'data/predictions\almnps_8878\embedding\ood_validation\science\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6827, Macro-f1: 0.5223, Weighted-f1: 0.6485, Loss: 1.1653
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5357, Macro-f1: 0.3636, Weighted-f1: 0.4921, Loss: 1.4537
Saved models from epoch 2 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
Saved model with best loss 1.4537 to 'data/predictions\almnps_8878\embedding\ood_validation\science\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8186, Macro-f1: 0.7107, Weighted-f1: 0.8025, Loss: 0.7198
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5489, Macro-f1: 0.3817, Weighted-f1: 0.5106, Loss: 1.4004
Saved models from epoch 3 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
Saved model with best loss 1.4004 to 'data/predictions\almnps_8878\embedding\ood_validation\science\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8983, Macro-f1: 0.8254, Weighted-f1: 0.8893, Loss: 0.4624
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5570, Macro-f1: 0.3902, Weighted-f1: 0.5215, Loss: 1.4360
Saved models from epoch 4 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9443, Macro-f1: 0.8945, Weighted-f1: 0.9391, Loss: 0.2904
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5634, Macro-f1: 0.3993, Weighted-f1: 0.5314, Loss: 1.4237
Saved models from epoch 5 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9807, Macro-f1: 0.9630, Weighted-f1: 0.9776, Loss: 0.1780
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5697, Macro-f1: 0.4078, Weighted-f1: 0.5390, Loss: 1.4477
Saved models from epoch 6 to 'data/predictions\almnps_8878\embedding\ood_validation\science\newest.pt'.
No improvement since 3 epochs (1.4004 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		embedding
