Saved arguments to data/predictions\almnps_8878\topological\ood_validation\args.json.
Saved category mapping to data/predictions\almnps_8878\topological\ood_validation\entity2category_mapping.json.
Loaded category mapping: topological.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117E99D7F70> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117E99D7FD0> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3883, Macro-f1: 0.2098, Weighted-f1: 0.3188, Loss: 2.0757
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5235, Macro-f1: 0.3281, Weighted-f1: 0.4590, Loss: 1.6943
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
Saved model with best loss 1.6943 to 'data/predictions\almnps_8878\topological\ood_validation\ai\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7280, Macro-f1: 0.5776, Weighted-f1: 0.6960, Loss: 1.0702
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5401, Macro-f1: 0.3573, Weighted-f1: 0.4875, Loss: 1.4824
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
Saved model with best loss 1.4824 to 'data/predictions\almnps_8878\topological\ood_validation\ai\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8397, Macro-f1: 0.7279, Weighted-f1: 0.8241, Loss: 0.6472
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5539, Macro-f1: 0.3791, Weighted-f1: 0.5058, Loss: 1.4553
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
Saved model with best loss 1.4553 to 'data/predictions\almnps_8878\topological\ood_validation\ai\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9093, Macro-f1: 0.8491, Weighted-f1: 0.9012, Loss: 0.4179
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5644, Macro-f1: 0.3937, Weighted-f1: 0.5194, Loss: 1.3933
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
Saved model with best loss 1.3933 to 'data/predictions\almnps_8878\topological\ood_validation\ai\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9390, Macro-f1: 0.8913, Weighted-f1: 0.9380, Loss: 0.2826
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5726, Macro-f1: 0.4035, Weighted-f1: 0.5294, Loss: 1.3933
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9708, Macro-f1: 0.9405, Weighted-f1: 0.9698, Loss: 0.1792
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5793, Macro-f1: 0.4121, Weighted-f1: 0.5392, Loss: 1.3888
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
Saved model with best loss 1.3888 to 'data/predictions\almnps_8878\topological\ood_validation\ai\best.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9795, Macro-f1: 0.9575, Weighted-f1: 0.9780, Loss: 0.1271
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5845, Macro-f1: 0.4180, Weighted-f1: 0.5454, Loss: 1.4435
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9913, Macro-f1: 0.9841, Weighted-f1: 0.9906, Loss: 0.0808
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5889, Macro-f1: 0.4240, Weighted-f1: 0.5515, Loss: 1.4906
Saved models from epoch 8 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
[Epoch 9/50] Train completed with Micro-f1: 0.9939, Macro-f1: 0.9889, Weighted-f1: 0.9935, Loss: 0.0607
[Epoch 9/50] Evaluation completed with Micro-f1: 0.5932, Macro-f1: 0.4283, Weighted-f1: 0.5571, Loss: 1.5468
Saved models from epoch 9 to 'data/predictions\almnps_8878\topological\ood_validation\ai\newest.pt'.
No improvement since 3 epochs (1.3888 loss). Early stop.
OOD training completed for test topic ai after 9 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178DE9E5B0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117E99D7670> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3489, Macro-f1: 0.1902, Weighted-f1: 0.2730, Loss: 2.1320
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4753, Macro-f1: 0.3164, Weighted-f1: 0.4325, Loss: 1.7681
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
Saved model with best loss 1.7681 to 'data/predictions\almnps_8878\topological\ood_validation\literature\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6940, Macro-f1: 0.5706, Weighted-f1: 0.6605, Loss: 1.1277
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5031, Macro-f1: 0.3538, Weighted-f1: 0.4697, Loss: 1.5279
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
Saved model with best loss 1.5279 to 'data/predictions\almnps_8878\topological\ood_validation\literature\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8316, Macro-f1: 0.7370, Weighted-f1: 0.8174, Loss: 0.6685
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5231, Macro-f1: 0.3754, Weighted-f1: 0.4942, Loss: 1.4514
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4514 to 'data/predictions\almnps_8878\topological\ood_validation\literature\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8999, Macro-f1: 0.8369, Weighted-f1: 0.8967, Loss: 0.4208
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5361, Macro-f1: 0.3916, Weighted-f1: 0.5103, Loss: 1.4315
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4315 to 'data/predictions\almnps_8878\topological\ood_validation\literature\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9409, Macro-f1: 0.8989, Weighted-f1: 0.9360, Loss: 0.2788
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5440, Macro-f1: 0.4009, Weighted-f1: 0.5199, Loss: 1.4478
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9735, Macro-f1: 0.9547, Weighted-f1: 0.9717, Loss: 0.1796
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5486, Macro-f1: 0.4085, Weighted-f1: 0.5263, Loss: 1.4876
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9868, Macro-f1: 0.9793, Weighted-f1: 0.9860, Loss: 0.1119
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5536, Macro-f1: 0.4143, Weighted-f1: 0.5325, Loss: 1.5756
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\literature\newest.pt'.
No improvement since 3 epochs (1.4315 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117EEB81070> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178DE9E760> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3094, Macro-f1: 0.1771, Weighted-f1: 0.2452, Loss: 2.2283
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4260, Macro-f1: 0.2807, Weighted-f1: 0.3865, Loss: 1.9315
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
Saved model with best loss 1.9315 to 'data/predictions\almnps_8878\topological\ood_validation\music\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6506, Macro-f1: 0.5050, Weighted-f1: 0.6156, Loss: 1.2999
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4634, Macro-f1: 0.3130, Weighted-f1: 0.4262, Loss: 1.6572
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
Saved model with best loss 1.6572 to 'data/predictions\almnps_8878\topological\ood_validation\music\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.7883, Macro-f1: 0.6815, Weighted-f1: 0.7696, Loss: 0.8345
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4797, Macro-f1: 0.3312, Weighted-f1: 0.4466, Loss: 1.6055
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
Saved model with best loss 1.6055 to 'data/predictions\almnps_8878\topological\ood_validation\music\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8757, Macro-f1: 0.7849, Weighted-f1: 0.8616, Loss: 0.5327
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4913, Macro-f1: 0.3438, Weighted-f1: 0.4600, Loss: 1.5725
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
Saved model with best loss 1.5725 to 'data/predictions\almnps_8878\topological\ood_validation\music\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9219, Macro-f1: 0.8659, Weighted-f1: 0.9165, Loss: 0.3540
[Epoch 5/50] Evaluation completed with Micro-f1: 0.4992, Macro-f1: 0.3536, Weighted-f1: 0.4696, Loss: 1.5908
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9693, Macro-f1: 0.9410, Weighted-f1: 0.9666, Loss: 0.2203
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5063, Macro-f1: 0.3628, Weighted-f1: 0.4794, Loss: 1.6332
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9905, Macro-f1: 0.9746, Weighted-f1: 0.9902, Loss: 0.1450
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5125, Macro-f1: 0.3698, Weighted-f1: 0.4875, Loss: 1.6650
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\music\newest.pt'.
No improvement since 3 epochs (1.5725 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178E37F910> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117EEB72FD0> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3992, Macro-f1: 0.2496, Weighted-f1: 0.3425, Loss: 2.0525
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5028, Macro-f1: 0.3355, Weighted-f1: 0.4566, Loss: 1.6737
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
Saved model with best loss 1.6737 to 'data/predictions\almnps_8878\topological\ood_validation\news\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7287, Macro-f1: 0.5904, Weighted-f1: 0.6999, Loss: 1.0484
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5323, Macro-f1: 0.3702, Weighted-f1: 0.4921, Loss: 1.4515
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
Saved model with best loss 1.4515 to 'data/predictions\almnps_8878\topological\ood_validation\news\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8400, Macro-f1: 0.7478, Weighted-f1: 0.8255, Loss: 0.6352
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5485, Macro-f1: 0.3875, Weighted-f1: 0.5119, Loss: 1.3721
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
Saved model with best loss 1.3721 to 'data/predictions\almnps_8878\topological\ood_validation\news\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9105, Macro-f1: 0.8520, Weighted-f1: 0.9031, Loss: 0.4018
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5600, Macro-f1: 0.3994, Weighted-f1: 0.5261, Loss: 1.3495
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
Saved model with best loss 1.3495 to 'data/predictions\almnps_8878\topological\ood_validation\news\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9448, Macro-f1: 0.9071, Weighted-f1: 0.9398, Loss: 0.2651
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5667, Macro-f1: 0.4083, Weighted-f1: 0.5347, Loss: 1.4084
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9768, Macro-f1: 0.9584, Weighted-f1: 0.9759, Loss: 0.1647
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5730, Macro-f1: 0.4155, Weighted-f1: 0.5428, Loss: 1.3797
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9858, Macro-f1: 0.9771, Weighted-f1: 0.9849, Loss: 0.1155
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5783, Macro-f1: 0.4225, Weighted-f1: 0.5495, Loss: 1.4205
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\news\newest.pt'.
No improvement since 3 epochs (1.3495 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178E2CA6D0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178E388EE0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3703, Macro-f1: 0.2061, Weighted-f1: 0.3022, Loss: 2.1451
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4856, Macro-f1: 0.3104, Weighted-f1: 0.4403, Loss: 1.7764
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
Saved model with best loss 1.7764 to 'data/predictions\almnps_8878\topological\ood_validation\politics\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6962, Macro-f1: 0.5594, Weighted-f1: 0.6593, Loss: 1.1555
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5277, Macro-f1: 0.3542, Weighted-f1: 0.4854, Loss: 1.4571
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
Saved model with best loss 1.4571 to 'data/predictions\almnps_8878\topological\ood_validation\politics\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8255, Macro-f1: 0.7243, Weighted-f1: 0.8106, Loss: 0.7124
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5493, Macro-f1: 0.3766, Weighted-f1: 0.5080, Loss: 1.3609
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3609 to 'data/predictions\almnps_8878\topological\ood_validation\politics\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8942, Macro-f1: 0.8217, Weighted-f1: 0.8872, Loss: 0.4746
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5625, Macro-f1: 0.3934, Weighted-f1: 0.5234, Loss: 1.3061
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3061 to 'data/predictions\almnps_8878\topological\ood_validation\politics\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9468, Macro-f1: 0.9017, Weighted-f1: 0.9436, Loss: 0.2963
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5736, Macro-f1: 0.4061, Weighted-f1: 0.5370, Loss: 1.3376
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9704, Macro-f1: 0.9390, Weighted-f1: 0.9668, Loss: 0.2000
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5809, Macro-f1: 0.4149, Weighted-f1: 0.5468, Loss: 1.3007
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3007 to 'data/predictions\almnps_8878\topological\ood_validation\politics\best.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9833, Macro-f1: 0.9703, Weighted-f1: 0.9824, Loss: 0.1356
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5865, Macro-f1: 0.4208, Weighted-f1: 0.5529, Loss: 1.3415
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9933, Macro-f1: 0.9855, Weighted-f1: 0.9928, Loss: 0.0893
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5918, Macro-f1: 0.4272, Weighted-f1: 0.5601, Loss: 1.3358
Saved models from epoch 8 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
[Epoch 9/50] Train completed with Micro-f1: 0.9922, Macro-f1: 0.9859, Weighted-f1: 0.9923, Loss: 0.0691
[Epoch 9/50] Evaluation completed with Micro-f1: 0.5955, Macro-f1: 0.4315, Weighted-f1: 0.5650, Loss: 1.3582
Saved models from epoch 9 to 'data/predictions\almnps_8878\topological\ood_validation\politics\newest.pt'.
No improvement since 3 epochs (1.3007 loss). Early stop.
OOD training completed for test topic politics after 9 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000117EEC4EDC0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x000001178E2C2C40> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3972, Macro-f1: 0.2282, Weighted-f1: 0.3260, Loss: 2.0573
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5350, Macro-f1: 0.3556, Weighted-f1: 0.4861, Loss: 1.6649
Saved models from epoch 1 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
Saved model with best loss 1.6649 to 'data/predictions\almnps_8878\topological\ood_validation\science\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6967, Macro-f1: 0.5493, Weighted-f1: 0.6588, Loss: 1.0978
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5565, Macro-f1: 0.3787, Weighted-f1: 0.5150, Loss: 1.4391
Saved models from epoch 2 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
Saved model with best loss 1.4391 to 'data/predictions\almnps_8878\topological\ood_validation\science\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8296, Macro-f1: 0.7059, Weighted-f1: 0.8133, Loss: 0.6708
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5715, Macro-f1: 0.3982, Weighted-f1: 0.5343, Loss: 1.3779
Saved models from epoch 3 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
Saved model with best loss 1.3779 to 'data/predictions\almnps_8878\topological\ood_validation\science\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8973, Macro-f1: 0.8164, Weighted-f1: 0.8877, Loss: 0.4161
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5790, Macro-f1: 0.4076, Weighted-f1: 0.5455, Loss: 1.3717
Saved models from epoch 4 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
Saved model with best loss 1.3717 to 'data/predictions\almnps_8878\topological\ood_validation\science\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9458, Macro-f1: 0.9076, Weighted-f1: 0.9409, Loss: 0.2696
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5867, Macro-f1: 0.4177, Weighted-f1: 0.5561, Loss: 1.3914
Saved models from epoch 5 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9718, Macro-f1: 0.9472, Weighted-f1: 0.9683, Loss: 0.1726
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5940, Macro-f1: 0.4274, Weighted-f1: 0.5648, Loss: 1.5017
Saved models from epoch 6 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9859, Macro-f1: 0.9718, Weighted-f1: 0.9841, Loss: 0.1177
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5976, Macro-f1: 0.4330, Weighted-f1: 0.5701, Loss: 1.5426
Saved models from epoch 7 to 'data/predictions\almnps_8878\topological\ood_validation\science\newest.pt'.
No improvement since 3 epochs (1.3717 loss). Early stop.
OOD training completed for test topic science after 7 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		topological
