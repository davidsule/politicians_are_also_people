Saved arguments to data/predictions/almnps_5096/manual/ood_validation/args.json.
Saved category mapping to data/predictions/almnps_5096/manual/ood_validation/entity2category_mapping.json.
Loaded category mapping: manual.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146ef9f10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146f02550> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4445, Macro-f1: 0.2738, Weighted-f1: 0.3713, Loss: 1.9326
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5420, Macro-f1: 0.3552, Weighted-f1: 0.4863, Loss: 1.5962
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5962 to 'data/predictions/almnps_5096/manual/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7345, Macro-f1: 0.5729, Weighted-f1: 0.6996, Loss: 0.9836
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5515, Macro-f1: 0.3753, Weighted-f1: 0.5097, Loss: 1.4735
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4735 to 'data/predictions/almnps_5096/manual/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8545, Macro-f1: 0.7525, Weighted-f1: 0.8416, Loss: 0.5917
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5667, Macro-f1: 0.3960, Weighted-f1: 0.5287, Loss: 1.3589
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.3589 to 'data/predictions/almnps_5096/manual/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9132, Macro-f1: 0.8471, Weighted-f1: 0.9027, Loss: 0.3734
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5757, Macro-f1: 0.4124, Weighted-f1: 0.5427, Loss: 1.4599
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9579, Macro-f1: 0.9249, Weighted-f1: 0.9534, Loss: 0.2290
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5834, Macro-f1: 0.4211, Weighted-f1: 0.5538, Loss: 1.5321
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9755, Macro-f1: 0.9508, Weighted-f1: 0.9738, Loss: 0.1433
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5875, Macro-f1: 0.4264, Weighted-f1: 0.5588, Loss: 1.5209
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.3589 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f51489e8460> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146f020d0> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3982, Macro-f1: 0.2468, Weighted-f1: 0.3299, Loss: 2.0310
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5336, Macro-f1: 0.3805, Weighted-f1: 0.4982, Loss: 1.6366
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.6366 to 'data/predictions/almnps_5096/manual/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7371, Macro-f1: 0.6102, Weighted-f1: 0.7132, Loss: 0.9950
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5481, Macro-f1: 0.3940, Weighted-f1: 0.5157, Loss: 1.4483
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4483 to 'data/predictions/almnps_5096/manual/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8589, Macro-f1: 0.7791, Weighted-f1: 0.8459, Loss: 0.5857
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5581, Macro-f1: 0.4062, Weighted-f1: 0.5289, Loss: 1.4563
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9258, Macro-f1: 0.8710, Weighted-f1: 0.9219, Loss: 0.3531
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5672, Macro-f1: 0.4155, Weighted-f1: 0.5395, Loss: 1.4115
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4115 to 'data/predictions/almnps_5096/manual/ood_validation/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9705, Macro-f1: 0.9504, Weighted-f1: 0.9672, Loss: 0.2079
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5733, Macro-f1: 0.4247, Weighted-f1: 0.5478, Loss: 1.4649
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9863, Macro-f1: 0.9783, Weighted-f1: 0.9853, Loss: 0.1337
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5791, Macro-f1: 0.4319, Weighted-f1: 0.5547, Loss: 1.4880
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9921, Macro-f1: 0.9880, Weighted-f1: 0.9923, Loss: 0.0925
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5832, Macro-f1: 0.4367, Weighted-f1: 0.5598, Loss: 1.4797
Saved models from epoch 7 to 'data/predictions/almnps_5096/manual/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4115 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146c03640> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f51489c69a0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3578, Macro-f1: 0.2060, Weighted-f1: 0.2842, Loss: 2.1415
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4731, Macro-f1: 0.3177, Weighted-f1: 0.4321, Loss: 1.7961
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.7961 to 'data/predictions/almnps_5096/manual/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6815, Macro-f1: 0.5499, Weighted-f1: 0.6503, Loss: 1.1779
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4991, Macro-f1: 0.3437, Weighted-f1: 0.4640, Loss: 1.5701
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.5701 to 'data/predictions/almnps_5096/manual/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8161, Macro-f1: 0.7247, Weighted-f1: 0.8007, Loss: 0.7154
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5136, Macro-f1: 0.3600, Weighted-f1: 0.4805, Loss: 1.4774
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.4774 to 'data/predictions/almnps_5096/manual/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8954, Macro-f1: 0.8281, Weighted-f1: 0.8846, Loss: 0.4499
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5250, Macro-f1: 0.3743, Weighted-f1: 0.4954, Loss: 1.5309
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9561, Macro-f1: 0.9190, Weighted-f1: 0.9533, Loss: 0.2746
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5306, Macro-f1: 0.3807, Weighted-f1: 0.5042, Loss: 1.5676
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9733, Macro-f1: 0.9511, Weighted-f1: 0.9714, Loss: 0.1814
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5381, Macro-f1: 0.3905, Weighted-f1: 0.5134, Loss: 1.5253
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.4774 loss). Early stop.
OOD training completed for test topic music after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146ba20d0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146d06850> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4355, Macro-f1: 0.2822, Weighted-f1: 0.3820, Loss: 1.9482
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5439, Macro-f1: 0.3825, Weighted-f1: 0.5072, Loss: 1.5537
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.5537 to 'data/predictions/almnps_5096/manual/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7632, Macro-f1: 0.6429, Weighted-f1: 0.7414, Loss: 0.9340
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5626, Macro-f1: 0.4020, Weighted-f1: 0.5261, Loss: 1.3780
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.3780 to 'data/predictions/almnps_5096/manual/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8542, Macro-f1: 0.7589, Weighted-f1: 0.8427, Loss: 0.5511
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5761, Macro-f1: 0.4205, Weighted-f1: 0.5436, Loss: 1.3452
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.3452 to 'data/predictions/almnps_5096/manual/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9285, Macro-f1: 0.8753, Weighted-f1: 0.9211, Loss: 0.3175
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5866, Macro-f1: 0.4332, Weighted-f1: 0.5562, Loss: 1.3626
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9647, Macro-f1: 0.9363, Weighted-f1: 0.9620, Loss: 0.1991
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5949, Macro-f1: 0.4433, Weighted-f1: 0.5669, Loss: 1.4172
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9809, Macro-f1: 0.9655, Weighted-f1: 0.9796, Loss: 0.1244
[Epoch 6/50] Evaluation completed with Micro-f1: 0.6012, Macro-f1: 0.4513, Weighted-f1: 0.5754, Loss: 1.4754
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.3452 loss). Early stop.
OOD training completed for test topic news after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5127b54f10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5146cca280> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3994, Macro-f1: 0.2530, Weighted-f1: 0.3510, Loss: 2.0646
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5394, Macro-f1: 0.3666, Weighted-f1: 0.4969, Loss: 1.6180
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.6180 to 'data/predictions/almnps_5096/manual/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7195, Macro-f1: 0.5882, Weighted-f1: 0.6917, Loss: 1.0606
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5620, Macro-f1: 0.3876, Weighted-f1: 0.5215, Loss: 1.3906
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3906 to 'data/predictions/almnps_5096/manual/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8476, Macro-f1: 0.7472, Weighted-f1: 0.8317, Loss: 0.6447
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5782, Macro-f1: 0.4085, Weighted-f1: 0.5428, Loss: 1.3276
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3276 to 'data/predictions/almnps_5096/manual/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9079, Macro-f1: 0.8350, Weighted-f1: 0.9012, Loss: 0.4000
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5885, Macro-f1: 0.4226, Weighted-f1: 0.5570, Loss: 1.3115
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3115 to 'data/predictions/almnps_5096/manual/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9520, Macro-f1: 0.9171, Weighted-f1: 0.9494, Loss: 0.2572
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5954, Macro-f1: 0.4315, Weighted-f1: 0.5652, Loss: 1.3403
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9769, Macro-f1: 0.9563, Weighted-f1: 0.9746, Loss: 0.1630
[Epoch 6/50] Evaluation completed with Micro-f1: 0.6013, Macro-f1: 0.4385, Weighted-f1: 0.5727, Loss: 1.3330
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9865, Macro-f1: 0.9763, Weighted-f1: 0.9854, Loss: 0.1051
[Epoch 7/50] Evaluation completed with Micro-f1: 0.6052, Macro-f1: 0.4430, Weighted-f1: 0.5772, Loss: 1.3949
Saved models from epoch 7 to 'data/predictions/almnps_5096/manual/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.3115 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f5127b74670> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f51279e0070> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4011, Macro-f1: 0.2404, Weighted-f1: 0.3275, Loss: 2.0112
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5563, Macro-f1: 0.3877, Weighted-f1: 0.5116, Loss: 1.5803
Saved models from epoch 1 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
Saved model with best loss 1.5803 to 'data/predictions/almnps_5096/manual/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7302, Macro-f1: 0.5872, Weighted-f1: 0.6950, Loss: 1.0038
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5733, Macro-f1: 0.4049, Weighted-f1: 0.5357, Loss: 1.3787
Saved models from epoch 2 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
Saved model with best loss 1.3787 to 'data/predictions/almnps_5096/manual/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8442, Macro-f1: 0.7478, Weighted-f1: 0.8288, Loss: 0.6095
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5860, Macro-f1: 0.4199, Weighted-f1: 0.5525, Loss: 1.3426
Saved models from epoch 3 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
Saved model with best loss 1.3426 to 'data/predictions/almnps_5096/manual/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9150, Macro-f1: 0.8549, Weighted-f1: 0.9076, Loss: 0.3775
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5931, Macro-f1: 0.4299, Weighted-f1: 0.5623, Loss: 1.3970
Saved models from epoch 4 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9560, Macro-f1: 0.9234, Weighted-f1: 0.9553, Loss: 0.2301
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5994, Macro-f1: 0.4366, Weighted-f1: 0.5692, Loss: 1.4099
Saved models from epoch 5 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9782, Macro-f1: 0.9605, Weighted-f1: 0.9748, Loss: 0.1502
[Epoch 6/50] Evaluation completed with Micro-f1: 0.6052, Macro-f1: 0.4439, Weighted-f1: 0.5776, Loss: 1.3738
Saved models from epoch 6 to 'data/predictions/almnps_5096/manual/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3426 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		manual
