Saved arguments to data/predictions\almnps_5096\manual\ood_validation\args.json.
Saved category mapping to data/predictions\almnps_5096\manual\ood_validation\entity2category_mapping.json.
Loaded category mapping: manual.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197D8B2F7C0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197D8B2F5B0> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4114, Macro-f1: 0.2239, Weighted-f1: 0.3324, Loss: 2.0300
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5294, Macro-f1: 0.3252, Weighted-f1: 0.4646, Loss: 1.6501
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
Saved model with best loss 1.6501 to 'data/predictions\almnps_5096\manual\ood_validation\ai\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7111, Macro-f1: 0.5400, Weighted-f1: 0.6648, Loss: 1.0637
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5458, Macro-f1: 0.3583, Weighted-f1: 0.4981, Loss: 1.4548
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
Saved model with best loss 1.4548 to 'data/predictions\almnps_5096\manual\ood_validation\ai\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8427, Macro-f1: 0.7351, Weighted-f1: 0.8272, Loss: 0.6478
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5577, Macro-f1: 0.3757, Weighted-f1: 0.5154, Loss: 1.3590
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
Saved model with best loss 1.3590 to 'data/predictions\almnps_5096\manual\ood_validation\ai\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9027, Macro-f1: 0.8211, Weighted-f1: 0.8891, Loss: 0.4125
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5677, Macro-f1: 0.3923, Weighted-f1: 0.5289, Loss: 1.3607
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9462, Macro-f1: 0.8999, Weighted-f1: 0.9387, Loss: 0.2576
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5750, Macro-f1: 0.4018, Weighted-f1: 0.5389, Loss: 1.4787
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9739, Macro-f1: 0.9475, Weighted-f1: 0.9717, Loss: 0.1640
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5803, Macro-f1: 0.4096, Weighted-f1: 0.5460, Loss: 1.4939
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\ai\newest.pt'.
No improvement since 3 epochs (1.3590 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197BC21BFA0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197D8B2FC40> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3616, Macro-f1: 0.2029, Weighted-f1: 0.2895, Loss: 2.1353
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5248, Macro-f1: 0.3647, Weighted-f1: 0.4866, Loss: 1.6922
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
Saved model with best loss 1.6922 to 'data/predictions\almnps_5096\manual\ood_validation\literature\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7176, Macro-f1: 0.5856, Weighted-f1: 0.6876, Loss: 1.0896
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5425, Macro-f1: 0.3838, Weighted-f1: 0.5086, Loss: 1.4608
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4608 to 'data/predictions\almnps_5096\manual\ood_validation\literature\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8352, Macro-f1: 0.7498, Weighted-f1: 0.8217, Loss: 0.6613
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5514, Macro-f1: 0.3943, Weighted-f1: 0.5200, Loss: 1.4561
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4561 to 'data/predictions\almnps_5096\manual\ood_validation\literature\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9044, Macro-f1: 0.8411, Weighted-f1: 0.8977, Loss: 0.4145
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5582, Macro-f1: 0.4013, Weighted-f1: 0.5280, Loss: 1.4083
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
Saved model with best loss 1.4083 to 'data/predictions\almnps_5096\manual\ood_validation\literature\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9518, Macro-f1: 0.9197, Weighted-f1: 0.9478, Loss: 0.2707
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5654, Macro-f1: 0.4117, Weighted-f1: 0.5370, Loss: 1.4550
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9783, Macro-f1: 0.9642, Weighted-f1: 0.9765, Loss: 0.1686
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5705, Macro-f1: 0.4182, Weighted-f1: 0.5428, Loss: 1.5019
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9894, Macro-f1: 0.9818, Weighted-f1: 0.9899, Loss: 0.1119
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5752, Macro-f1: 0.4237, Weighted-f1: 0.5486, Loss: 1.4800
Saved models from epoch 7 to 'data/predictions\almnps_5096\manual\ood_validation\literature\newest.pt'.
No improvement since 3 epochs (1.4083 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197DB0590D0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197BC210310> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3288, Macro-f1: 0.1675, Weighted-f1: 0.2485, Loss: 2.2262
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4394, Macro-f1: 0.2735, Weighted-f1: 0.3897, Loss: 1.9200
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
Saved model with best loss 1.9200 to 'data/predictions\almnps_5096\manual\ood_validation\music\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6791, Macro-f1: 0.5476, Weighted-f1: 0.6484, Loss: 1.2627
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4802, Macro-f1: 0.3196, Weighted-f1: 0.4387, Loss: 1.6341
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
Saved model with best loss 1.6341 to 'data/predictions\almnps_5096\manual\ood_validation\music\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8041, Macro-f1: 0.7058, Weighted-f1: 0.7865, Loss: 0.7835
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4986, Macro-f1: 0.3430, Weighted-f1: 0.4623, Loss: 1.5163
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
Saved model with best loss 1.5163 to 'data/predictions\almnps_5096\manual\ood_validation\music\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8908, Macro-f1: 0.8206, Weighted-f1: 0.8803, Loss: 0.5023
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5115, Macro-f1: 0.3583, Weighted-f1: 0.4795, Loss: 1.5532
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9431, Macro-f1: 0.9021, Weighted-f1: 0.9384, Loss: 0.3177
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5179, Macro-f1: 0.3666, Weighted-f1: 0.4886, Loss: 1.5817
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9739, Macro-f1: 0.9483, Weighted-f1: 0.9714, Loss: 0.2054
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5227, Macro-f1: 0.3727, Weighted-f1: 0.4942, Loss: 1.5755
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\music\newest.pt'.
No improvement since 3 epochs (1.5163 loss). Early stop.
OOD training completed for test topic music after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197E11ACE20> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197F5FDAE50> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4273, Macro-f1: 0.2620, Weighted-f1: 0.3675, Loss: 2.0040
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5349, Macro-f1: 0.3700, Weighted-f1: 0.4971, Loss: 1.6311
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
Saved model with best loss 1.6311 to 'data/predictions\almnps_5096\manual\ood_validation\news\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7388, Macro-f1: 0.6015, Weighted-f1: 0.7104, Loss: 1.0201
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5522, Macro-f1: 0.3902, Weighted-f1: 0.5148, Loss: 1.4241
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
Saved model with best loss 1.4241 to 'data/predictions\almnps_5096\manual\ood_validation\news\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8533, Macro-f1: 0.7654, Weighted-f1: 0.8368, Loss: 0.6203
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5659, Macro-f1: 0.4061, Weighted-f1: 0.5302, Loss: 1.3491
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
Saved model with best loss 1.3491 to 'data/predictions\almnps_5096\manual\ood_validation\news\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9078, Macro-f1: 0.8433, Weighted-f1: 0.8978, Loss: 0.4031
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5756, Macro-f1: 0.4190, Weighted-f1: 0.5431, Loss: 1.3730
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9519, Macro-f1: 0.9194, Weighted-f1: 0.9481, Loss: 0.2610
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5837, Macro-f1: 0.4278, Weighted-f1: 0.5527, Loss: 1.4057
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9717, Macro-f1: 0.9470, Weighted-f1: 0.9696, Loss: 0.1665
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5883, Macro-f1: 0.4340, Weighted-f1: 0.5597, Loss: 1.3949
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\news\newest.pt'.
No improvement since 3 epochs (1.3491 loss). Early stop.
OOD training completed for test topic news after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197BD352A30> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197DB0953A0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3904, Macro-f1: 0.2262, Weighted-f1: 0.3318, Loss: 2.1320
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5258, Macro-f1: 0.3301, Weighted-f1: 0.4745, Loss: 1.6926
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
Saved model with best loss 1.6926 to 'data/predictions\almnps_5096\manual\ood_validation\politics\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6869, Macro-f1: 0.5212, Weighted-f1: 0.6575, Loss: 1.1765
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5477, Macro-f1: 0.3601, Weighted-f1: 0.5005, Loss: 1.4539
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
Saved model with best loss 1.4539 to 'data/predictions\almnps_5096\manual\ood_validation\politics\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8192, Macro-f1: 0.7091, Weighted-f1: 0.7970, Loss: 0.7288
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5664, Macro-f1: 0.3837, Weighted-f1: 0.5255, Loss: 1.3534
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3534 to 'data/predictions\almnps_5096\manual\ood_validation\politics\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8849, Macro-f1: 0.8047, Weighted-f1: 0.8755, Loss: 0.4851
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5807, Macro-f1: 0.4032, Weighted-f1: 0.5439, Loss: 1.3110
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
Saved model with best loss 1.3110 to 'data/predictions\almnps_5096\manual\ood_validation\politics\best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9345, Macro-f1: 0.8778, Weighted-f1: 0.9286, Loss: 0.3226
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5890, Macro-f1: 0.4131, Weighted-f1: 0.5548, Loss: 1.2866
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
Saved model with best loss 1.2866 to 'data/predictions\almnps_5096\manual\ood_validation\politics\best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9639, Macro-f1: 0.9314, Weighted-f1: 0.9620, Loss: 0.2177
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5939, Macro-f1: 0.4194, Weighted-f1: 0.5610, Loss: 1.3340
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9821, Macro-f1: 0.9701, Weighted-f1: 0.9802, Loss: 0.1415
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5998, Macro-f1: 0.4271, Weighted-f1: 0.5688, Loss: 1.3035
Saved models from epoch 7 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9944, Macro-f1: 0.9918, Weighted-f1: 0.9947, Loss: 0.0927
[Epoch 8/50] Evaluation completed with Micro-f1: 0.6043, Macro-f1: 0.4325, Weighted-f1: 0.5739, Loss: 1.3639
Saved models from epoch 8 to 'data/predictions\almnps_5096\manual\ood_validation\politics\newest.pt'.
No improvement since 3 epochs (1.2866 loss). Early stop.
OOD training completed for test topic politics after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197DBAE8580> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x00000197A7AE2D00> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3957, Macro-f1: 0.2240, Weighted-f1: 0.3245, Loss: 2.0780
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5461, Macro-f1: 0.3622, Weighted-f1: 0.4994, Loss: 1.5943
Saved models from epoch 1 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
Saved model with best loss 1.5943 to 'data/predictions\almnps_5096\manual\ood_validation\science\best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7009, Macro-f1: 0.5469, Weighted-f1: 0.6676, Loss: 1.1190
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5645, Macro-f1: 0.3846, Weighted-f1: 0.5242, Loss: 1.3704
Saved models from epoch 2 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
Saved model with best loss 1.3704 to 'data/predictions\almnps_5096\manual\ood_validation\science\best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8275, Macro-f1: 0.7309, Weighted-f1: 0.8089, Loss: 0.6931
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5791, Macro-f1: 0.4045, Weighted-f1: 0.5434, Loss: 1.3194
Saved models from epoch 3 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
Saved model with best loss 1.3194 to 'data/predictions\almnps_5096\manual\ood_validation\science\best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9015, Macro-f1: 0.8346, Weighted-f1: 0.8939, Loss: 0.4430
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5882, Macro-f1: 0.4151, Weighted-f1: 0.5547, Loss: 1.3392
Saved models from epoch 4 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9406, Macro-f1: 0.8897, Weighted-f1: 0.9340, Loss: 0.2843
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5947, Macro-f1: 0.4238, Weighted-f1: 0.5631, Loss: 1.3485
Saved models from epoch 5 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9714, Macro-f1: 0.9520, Weighted-f1: 0.9682, Loss: 0.1860
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5998, Macro-f1: 0.4298, Weighted-f1: 0.5687, Loss: 1.4152
Saved models from epoch 6 to 'data/predictions\almnps_5096\manual\ood_validation\science\newest.pt'.
No improvement since 3 epochs (1.3194 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		manual
