Saved arguments to data/predictions/almnps_9908/topological/all/args.json.
Saved category mapping to data/predictions/almnps_9908/topological/all/entity2category_mapping.json.
Loaded category mapping: topological.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fbb187c2e80> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fbb187c2490> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4184, Macro-f1: 0.2687, Weighted-f1: 0.3535, Loss: 2.0076
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5167, Macro-f1: 0.3486, Weighted-f1: 0.4702, Loss: 1.7171
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
Saved model with best loss 1.7171 to 'data/predictions/almnps_9908/topological/all/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7092, Macro-f1: 0.5788, Weighted-f1: 0.6826, Loss: 1.0753
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5378, Macro-f1: 0.3753, Weighted-f1: 0.4969, Loss: 1.4952
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
Saved model with best loss 1.4952 to 'data/predictions/almnps_9908/topological/all/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8129, Macro-f1: 0.7164, Weighted-f1: 0.7960, Loss: 0.6962
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5507, Macro-f1: 0.3916, Weighted-f1: 0.5156, Loss: 1.3922
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
Saved model with best loss 1.3922 to 'data/predictions/almnps_9908/topological/all/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9015, Macro-f1: 0.8335, Weighted-f1: 0.8928, Loss: 0.4501
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5601, Macro-f1: 0.4022, Weighted-f1: 0.5257, Loss: 1.4129
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9449, Macro-f1: 0.9004, Weighted-f1: 0.9395, Loss: 0.2852
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5686, Macro-f1: 0.4128, Weighted-f1: 0.5367, Loss: 1.3847
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
Saved model with best loss 1.3847 to 'data/predictions/almnps_9908/topological/all/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9692, Macro-f1: 0.9430, Weighted-f1: 0.9677, Loss: 0.1898
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5748, Macro-f1: 0.4205, Weighted-f1: 0.5444, Loss: 1.4038
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9800, Macro-f1: 0.9710, Weighted-f1: 0.9791, Loss: 0.1302
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5799, Macro-f1: 0.4269, Weighted-f1: 0.5517, Loss: 1.4449
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9900, Macro-f1: 0.9832, Weighted-f1: 0.9890, Loss: 0.0893
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5838, Macro-f1: 0.4325, Weighted-f1: 0.5577, Loss: 1.4794
Saved models from epoch 8 to 'data/predictions/almnps_9908/topological/all/newest.pt'.
No improvement since 3 epochs (1.3847 loss). Early stop.
Training completed after 8 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	False
	Mapping type:		topological
