Saved arguments to data/predictions/almnps_9908/topological/ood_validation/args.json.
Saved category mapping to data/predictions/almnps_9908/topological/ood_validation/entity2category_mapping.json.
Loaded category mapping: topological.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa7a20fb160> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa7a20fb310> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4366, Macro-f1: 0.2654, Weighted-f1: 0.3671, Loss: 1.9644
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5137, Macro-f1: 0.3391, Weighted-f1: 0.4594, Loss: 1.6765
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.6765 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7474, Macro-f1: 0.6281, Weighted-f1: 0.7212, Loss: 0.9666
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5401, Macro-f1: 0.3712, Weighted-f1: 0.4950, Loss: 1.4389
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4389 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8576, Macro-f1: 0.7696, Weighted-f1: 0.8431, Loss: 0.5588
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5554, Macro-f1: 0.3901, Weighted-f1: 0.5148, Loss: 1.4155
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4155 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9200, Macro-f1: 0.8654, Weighted-f1: 0.9116, Loss: 0.3463
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5655, Macro-f1: 0.4033, Weighted-f1: 0.5291, Loss: 1.4170
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9595, Macro-f1: 0.9202, Weighted-f1: 0.9561, Loss: 0.2060
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5702, Macro-f1: 0.4099, Weighted-f1: 0.5347, Loss: 1.4936
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9823, Macro-f1: 0.9654, Weighted-f1: 0.9809, Loss: 0.1351
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5757, Macro-f1: 0.4174, Weighted-f1: 0.5425, Loss: 1.5017
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4155 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa77ec02fa0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa7a20fb220> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3837, Macro-f1: 0.2314, Weighted-f1: 0.3174, Loss: 2.0035
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4640, Macro-f1: 0.3294, Weighted-f1: 0.4182, Loss: 1.7498
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
Saved model with best loss 1.7498 to 'data/predictions/almnps_9908/topological/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7247, Macro-f1: 0.5968, Weighted-f1: 0.6990, Loss: 1.0286
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5033, Macro-f1: 0.3626, Weighted-f1: 0.4650, Loss: 1.4588
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4588 to 'data/predictions/almnps_9908/topological/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8408, Macro-f1: 0.7563, Weighted-f1: 0.8292, Loss: 0.6259
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5224, Macro-f1: 0.3828, Weighted-f1: 0.4875, Loss: 1.4832
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9105, Macro-f1: 0.8457, Weighted-f1: 0.9061, Loss: 0.4078
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5345, Macro-f1: 0.3931, Weighted-f1: 0.5025, Loss: 1.5111
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9474, Macro-f1: 0.9058, Weighted-f1: 0.9441, Loss: 0.2624
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5417, Macro-f1: 0.4005, Weighted-f1: 0.5105, Loss: 1.5172
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4588 loss). Early stop.
OOD training completed for test topic literature after 5 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79b9a4670> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa77eb546d0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3642, Macro-f1: 0.2196, Weighted-f1: 0.2909, Loss: 2.1248
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4798, Macro-f1: 0.3401, Weighted-f1: 0.4451, Loss: 1.8038
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.8038 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7183, Macro-f1: 0.5965, Weighted-f1: 0.6940, Loss: 1.1402
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5022, Macro-f1: 0.3585, Weighted-f1: 0.4722, Loss: 1.5694
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.5694 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8206, Macro-f1: 0.7130, Weighted-f1: 0.8012, Loss: 0.7017
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5146, Macro-f1: 0.3717, Weighted-f1: 0.4868, Loss: 1.5134
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.5134 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8887, Macro-f1: 0.8178, Weighted-f1: 0.8801, Loss: 0.4470
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5250, Macro-f1: 0.3815, Weighted-f1: 0.4993, Loss: 1.5687
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9517, Macro-f1: 0.9143, Weighted-f1: 0.9473, Loss: 0.2875
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5309, Macro-f1: 0.3887, Weighted-f1: 0.5069, Loss: 1.5449
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9711, Macro-f1: 0.9497, Weighted-f1: 0.9702, Loss: 0.1804
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5355, Macro-f1: 0.3947, Weighted-f1: 0.5134, Loss: 1.5840
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5134 loss). Early stop.
OOD training completed for test topic music after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa77ea01f70> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79b9aeca0> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4332, Macro-f1: 0.2763, Weighted-f1: 0.3703, Loss: 1.9530
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5370, Macro-f1: 0.3736, Weighted-f1: 0.4993, Loss: 1.5716
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.5716 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7474, Macro-f1: 0.6196, Weighted-f1: 0.7243, Loss: 0.9485
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5485, Macro-f1: 0.3898, Weighted-f1: 0.5110, Loss: 1.4759
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.4759 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8642, Macro-f1: 0.7694, Weighted-f1: 0.8492, Loss: 0.5526
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5611, Macro-f1: 0.4051, Weighted-f1: 0.5270, Loss: 1.4251
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.4251 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9200, Macro-f1: 0.8574, Weighted-f1: 0.9141, Loss: 0.3451
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5704, Macro-f1: 0.4180, Weighted-f1: 0.5397, Loss: 1.4114
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.4114 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9619, Macro-f1: 0.9288, Weighted-f1: 0.9572, Loss: 0.2124
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5760, Macro-f1: 0.4251, Weighted-f1: 0.5472, Loss: 1.4829
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9847, Macro-f1: 0.9702, Weighted-f1: 0.9839, Loss: 0.1234
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5808, Macro-f1: 0.4304, Weighted-f1: 0.5539, Loss: 1.5671
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9919, Macro-f1: 0.9863, Weighted-f1: 0.9916, Loss: 0.0797
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5848, Macro-f1: 0.4344, Weighted-f1: 0.5581, Loss: 1.5781
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.4114 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79ba62190> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79b84a5e0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3928, Macro-f1: 0.2428, Weighted-f1: 0.3335, Loss: 2.0732
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5177, Macro-f1: 0.3548, Weighted-f1: 0.4729, Loss: 1.6900
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.6900 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7118, Macro-f1: 0.5682, Weighted-f1: 0.6768, Loss: 1.0675
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5474, Macro-f1: 0.3812, Weighted-f1: 0.5084, Loss: 1.4222
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4222 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8528, Macro-f1: 0.7708, Weighted-f1: 0.8416, Loss: 0.6380
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5653, Macro-f1: 0.3989, Weighted-f1: 0.5298, Loss: 1.3365
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3365 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9119, Macro-f1: 0.8681, Weighted-f1: 0.9078, Loss: 0.4001
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5765, Macro-f1: 0.4117, Weighted-f1: 0.5433, Loss: 1.2988
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.2988 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9549, Macro-f1: 0.9174, Weighted-f1: 0.9495, Loss: 0.2450
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5843, Macro-f1: 0.4196, Weighted-f1: 0.5532, Loss: 1.3238
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9710, Macro-f1: 0.9415, Weighted-f1: 0.9688, Loss: 0.1598
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5903, Macro-f1: 0.4252, Weighted-f1: 0.5607, Loss: 1.3593
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9859, Macro-f1: 0.9780, Weighted-f1: 0.9859, Loss: 0.1110
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5945, Macro-f1: 0.4309, Weighted-f1: 0.5661, Loss: 1.4010
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.2988 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79ba2c4c0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa79ba97460> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4170, Macro-f1: 0.2589, Weighted-f1: 0.3556, Loss: 2.0466
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5516, Macro-f1: 0.3792, Weighted-f1: 0.5035, Loss: 1.6381
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.6381 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7084, Macro-f1: 0.5625, Weighted-f1: 0.6727, Loss: 1.0615
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5705, Macro-f1: 0.4057, Weighted-f1: 0.5314, Loss: 1.4614
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.4614 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8347, Macro-f1: 0.7360, Weighted-f1: 0.8205, Loss: 0.6398
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5807, Macro-f1: 0.4200, Weighted-f1: 0.5440, Loss: 1.4216
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.4216 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9072, Macro-f1: 0.8382, Weighted-f1: 0.8961, Loss: 0.3937
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5881, Macro-f1: 0.4274, Weighted-f1: 0.5545, Loss: 1.4527
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9529, Macro-f1: 0.9026, Weighted-f1: 0.9474, Loss: 0.2396
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5937, Macro-f1: 0.4345, Weighted-f1: 0.5624, Loss: 1.4576
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9771, Macro-f1: 0.9596, Weighted-f1: 0.9742, Loss: 0.1524
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5980, Macro-f1: 0.4398, Weighted-f1: 0.5683, Loss: 1.5519
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.4216 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		topological
