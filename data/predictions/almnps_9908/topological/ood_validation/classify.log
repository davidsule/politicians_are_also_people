Saved arguments to data/predictions/almnps_9908/topological/ood_validation/args.json.
Saved category mapping to data/predictions/almnps_9908/topological/ood_validation/entity2category_mapping.json.
Loaded category mapping: topological.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faa00420820> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faa00420b50> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4419, Macro-f1: 0.2771, Weighted-f1: 0.3739, Loss: 1.9545
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5237, Macro-f1: 0.3360, Weighted-f1: 0.4665, Loss: 1.6448
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.6448 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7521, Macro-f1: 0.6302, Weighted-f1: 0.7248, Loss: 0.9441
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5415, Macro-f1: 0.3678, Weighted-f1: 0.4927, Loss: 1.4567
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4567 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8643, Macro-f1: 0.7723, Weighted-f1: 0.8510, Loss: 0.5359
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5543, Macro-f1: 0.3849, Weighted-f1: 0.5101, Loss: 1.4260
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4260 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9319, Macro-f1: 0.8779, Weighted-f1: 0.9258, Loss: 0.3222
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5660, Macro-f1: 0.3996, Weighted-f1: 0.5257, Loss: 1.4045
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4045 to 'data/predictions/almnps_9908/topological/ood_validation/ai/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9683, Macro-f1: 0.9358, Weighted-f1: 0.9658, Loss: 0.1951
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5725, Macro-f1: 0.4078, Weighted-f1: 0.5338, Loss: 1.4756
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9818, Macro-f1: 0.9646, Weighted-f1: 0.9802, Loss: 0.1249
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5771, Macro-f1: 0.4149, Weighted-f1: 0.5411, Loss: 1.5179
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9922, Macro-f1: 0.9871, Weighted-f1: 0.9921, Loss: 0.0816
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5800, Macro-f1: 0.4192, Weighted-f1: 0.5448, Loss: 1.6077
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4045 loss). Early stop.
OOD training completed for test topic ai after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9e0e48160> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faa004204c0> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4074, Macro-f1: 0.2487, Weighted-f1: 0.3374, Loss: 1.9856
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5073, Macro-f1: 0.3573, Weighted-f1: 0.4744, Loss: 1.6682
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
Saved model with best loss 1.6682 to 'data/predictions/almnps_9908/topological/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7171, Macro-f1: 0.5832, Weighted-f1: 0.6899, Loss: 1.0444
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5233, Macro-f1: 0.3755, Weighted-f1: 0.4913, Loss: 1.4981
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4981 to 'data/predictions/almnps_9908/topological/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8442, Macro-f1: 0.7516, Weighted-f1: 0.8335, Loss: 0.6459
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5345, Macro-f1: 0.3870, Weighted-f1: 0.5050, Loss: 1.5179
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8926, Macro-f1: 0.8194, Weighted-f1: 0.8853, Loss: 0.4270
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5399, Macro-f1: 0.3934, Weighted-f1: 0.5102, Loss: 1.5551
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9474, Macro-f1: 0.9102, Weighted-f1: 0.9424, Loss: 0.2672
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5467, Macro-f1: 0.4032, Weighted-f1: 0.5202, Loss: 1.5575
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4981 loss). Early stop.
OOD training completed for test topic literature after 5 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9d45e0490> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9e0e50880> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3604, Macro-f1: 0.2143, Weighted-f1: 0.2949, Loss: 2.1555
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4512, Macro-f1: 0.3077, Weighted-f1: 0.4144, Loss: 1.8376
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.8376 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7010, Macro-f1: 0.5668, Weighted-f1: 0.6748, Loss: 1.1690
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4822, Macro-f1: 0.3361, Weighted-f1: 0.4460, Loss: 1.6328
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.6328 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8088, Macro-f1: 0.7068, Weighted-f1: 0.7897, Loss: 0.7317
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4975, Macro-f1: 0.3524, Weighted-f1: 0.4653, Loss: 1.5592
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.5592 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8972, Macro-f1: 0.8358, Weighted-f1: 0.8850, Loss: 0.4497
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5064, Macro-f1: 0.3645, Weighted-f1: 0.4772, Loss: 1.5324
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
Saved model with best loss 1.5324 to 'data/predictions/almnps_9908/topological/ood_validation/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9467, Macro-f1: 0.8963, Weighted-f1: 0.9413, Loss: 0.2856
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5158, Macro-f1: 0.3744, Weighted-f1: 0.4881, Loss: 1.5479
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9761, Macro-f1: 0.9523, Weighted-f1: 0.9737, Loss: 0.1784
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5235, Macro-f1: 0.3840, Weighted-f1: 0.4984, Loss: 1.5457
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9894, Macro-f1: 0.9796, Weighted-f1: 0.9881, Loss: 0.1158
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5287, Macro-f1: 0.3925, Weighted-f1: 0.5054, Loss: 1.6157
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5324 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9f9e1e460> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9d45ea370> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4213, Macro-f1: 0.2763, Weighted-f1: 0.3641, Loss: 1.9994
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5290, Macro-f1: 0.3732, Weighted-f1: 0.4882, Loss: 1.6460
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.6460 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7466, Macro-f1: 0.6344, Weighted-f1: 0.7232, Loss: 0.9740
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5511, Macro-f1: 0.3994, Weighted-f1: 0.5178, Loss: 1.4246
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.4246 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8686, Macro-f1: 0.7868, Weighted-f1: 0.8574, Loss: 0.5580
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5645, Macro-f1: 0.4134, Weighted-f1: 0.5340, Loss: 1.3879
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
Saved model with best loss 1.3879 to 'data/predictions/almnps_9908/topological/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9376, Macro-f1: 0.8862, Weighted-f1: 0.9325, Loss: 0.3252
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5725, Macro-f1: 0.4206, Weighted-f1: 0.5432, Loss: 1.4313
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9705, Macro-f1: 0.9504, Weighted-f1: 0.9692, Loss: 0.2029
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5799, Macro-f1: 0.4285, Weighted-f1: 0.5517, Loss: 1.3934
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9843, Macro-f1: 0.9740, Weighted-f1: 0.9828, Loss: 0.1236
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5850, Macro-f1: 0.4352, Weighted-f1: 0.5586, Loss: 1.4519
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.3879 loss). Early stop.
OOD training completed for test topic news after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9f9d3d730> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9f9bfb220> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4077, Macro-f1: 0.2597, Weighted-f1: 0.3466, Loss: 2.0224
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5251, Macro-f1: 0.3589, Weighted-f1: 0.4793, Loss: 1.6557
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.6557 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7326, Macro-f1: 0.6082, Weighted-f1: 0.7079, Loss: 1.0460
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5484, Macro-f1: 0.3828, Weighted-f1: 0.5085, Loss: 1.4359
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4359 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8516, Macro-f1: 0.7751, Weighted-f1: 0.8413, Loss: 0.6287
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5638, Macro-f1: 0.4005, Weighted-f1: 0.5262, Loss: 1.3377
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3377 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9036, Macro-f1: 0.8460, Weighted-f1: 0.8927, Loss: 0.4026
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5737, Macro-f1: 0.4118, Weighted-f1: 0.5420, Loss: 1.2990
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
Saved model with best loss 1.2990 to 'data/predictions/almnps_9908/topological/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9520, Macro-f1: 0.9112, Weighted-f1: 0.9492, Loss: 0.2500
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5825, Macro-f1: 0.4205, Weighted-f1: 0.5524, Loss: 1.3295
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9707, Macro-f1: 0.9514, Weighted-f1: 0.9694, Loss: 0.1716
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5895, Macro-f1: 0.4293, Weighted-f1: 0.5609, Loss: 1.3390
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9915, Macro-f1: 0.9827, Weighted-f1: 0.9905, Loss: 0.1023
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5929, Macro-f1: 0.4336, Weighted-f1: 0.5652, Loss: 1.4116
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.2990 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9e0b8abb0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa9f9d4fe20> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3996, Macro-f1: 0.2407, Weighted-f1: 0.3325, Loss: 2.0587
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5313, Macro-f1: 0.3738, Weighted-f1: 0.4939, Loss: 1.6577
Saved models from epoch 1 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.6577 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7107, Macro-f1: 0.5719, Weighted-f1: 0.6826, Loss: 1.0566
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5537, Macro-f1: 0.3984, Weighted-f1: 0.5156, Loss: 1.4443
Saved models from epoch 2 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.4443 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8442, Macro-f1: 0.7483, Weighted-f1: 0.8286, Loss: 0.6217
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5658, Macro-f1: 0.4096, Weighted-f1: 0.5303, Loss: 1.4017
Saved models from epoch 3 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.4017 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9183, Macro-f1: 0.8509, Weighted-f1: 0.9106, Loss: 0.3793
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5754, Macro-f1: 0.4204, Weighted-f1: 0.5425, Loss: 1.3284
Saved models from epoch 4 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
Saved model with best loss 1.3284 to 'data/predictions/almnps_9908/topological/ood_validation/science/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9590, Macro-f1: 0.9281, Weighted-f1: 0.9552, Loss: 0.2320
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5826, Macro-f1: 0.4293, Weighted-f1: 0.5516, Loss: 1.3777
Saved models from epoch 5 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9803, Macro-f1: 0.9613, Weighted-f1: 0.9782, Loss: 0.1452
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5883, Macro-f1: 0.4367, Weighted-f1: 0.5588, Loss: 1.4234
Saved models from epoch 6 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9910, Macro-f1: 0.9829, Weighted-f1: 0.9902, Loss: 0.0923
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5933, Macro-f1: 0.4431, Weighted-f1: 0.5647, Loss: 1.5288
Saved models from epoch 7 to 'data/predictions/almnps_9908/topological/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3284 loss). Early stop.
OOD training completed for test topic science after 7 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		topological
