Saved arguments to data/predictions/almnps_9908/ood_clustering/ood_validation/args.json.
Out of domain clustering of entities with domain-specific unique entities created and saved to: data/predictions/ood_clustering_data/9908/
loading projection weights from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz
KeyedVectors lifecycle event {'msg': 'loaded (3000000, 300) matrix of type float32 from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz', 'binary': True, 'encoding': 'utf8', 'datetime': '2023-05-10T00:31:21.899691', 'gensim': '4.3.0', 'python': '3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) \n[GCC 11.3.0]', 'platform': 'Linux-5.15.90.1-microsoft-standard-WSL2-x86_64-with-glibc2.31', 'event': 'load_word2vec_format'}
Saved category mapping to data/predictions/almnps_9908/ood_clustering/ood_validation/entity2category_mapping.json.
Loaded category mapping: ood_clustering.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be2897f0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5bd91cd00> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3921, Macro-f1: 0.2025, Weighted-f1: 0.3153, Loss: 2.0906
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5020, Macro-f1: 0.3146, Weighted-f1: 0.4433, Loss: 1.7322
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.7322 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6992, Macro-f1: 0.5303, Weighted-f1: 0.6619, Loss: 1.0965
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5224, Macro-f1: 0.3433, Weighted-f1: 0.4741, Loss: 1.5018
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5018 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8346, Macro-f1: 0.7255, Weighted-f1: 0.8197, Loss: 0.6636
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5328, Macro-f1: 0.3618, Weighted-f1: 0.4896, Loss: 1.5684
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9047, Macro-f1: 0.8332, Weighted-f1: 0.8969, Loss: 0.4189
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5440, Macro-f1: 0.3737, Weighted-f1: 0.5023, Loss: 1.4588
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4588 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9396, Macro-f1: 0.8970, Weighted-f1: 0.9357, Loss: 0.2748
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5528, Macro-f1: 0.3852, Weighted-f1: 0.5148, Loss: 1.4885
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9706, Macro-f1: 0.9471, Weighted-f1: 0.9673, Loss: 0.1795
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5587, Macro-f1: 0.3924, Weighted-f1: 0.5228, Loss: 1.5446
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9854, Macro-f1: 0.9728, Weighted-f1: 0.9846, Loss: 0.1151
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5631, Macro-f1: 0.3983, Weighted-f1: 0.5285, Loss: 1.5942
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4588 loss). Early stop.
OOD training completed for test topic ai after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be506b50> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be289d00> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3818, Macro-f1: 0.2155, Weighted-f1: 0.3186, Loss: 2.1024
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4902, Macro-f1: 0.3278, Weighted-f1: 0.4475, Loss: 1.7751
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.7751 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6834, Macro-f1: 0.5332, Weighted-f1: 0.6506, Loss: 1.1466
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5105, Macro-f1: 0.3500, Weighted-f1: 0.4697, Loss: 1.5271
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.5271 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8239, Macro-f1: 0.7177, Weighted-f1: 0.8046, Loss: 0.6987
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5246, Macro-f1: 0.3688, Weighted-f1: 0.4896, Loss: 1.4507
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4507 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9010, Macro-f1: 0.8353, Weighted-f1: 0.8938, Loss: 0.4433
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5356, Macro-f1: 0.3839, Weighted-f1: 0.5041, Loss: 1.4344
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4344 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9430, Macro-f1: 0.8891, Weighted-f1: 0.9371, Loss: 0.2849
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5433, Macro-f1: 0.3922, Weighted-f1: 0.5135, Loss: 1.4563
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9746, Macro-f1: 0.9538, Weighted-f1: 0.9733, Loss: 0.1812
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5486, Macro-f1: 0.3995, Weighted-f1: 0.5207, Loss: 1.5064
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9942, Macro-f1: 0.9890, Weighted-f1: 0.9940, Loss: 0.1132
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5527, Macro-f1: 0.4039, Weighted-f1: 0.5253, Loss: 1.5421
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4344 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be4f07c0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa6ffb690d0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3339, Macro-f1: 0.1823, Weighted-f1: 0.2636, Loss: 2.2182
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4499, Macro-f1: 0.2837, Weighted-f1: 0.3949, Loss: 1.9197
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.9197 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6594, Macro-f1: 0.5085, Weighted-f1: 0.6245, Loss: 1.2924
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4709, Macro-f1: 0.3149, Weighted-f1: 0.4278, Loss: 1.7109
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.7109 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.7847, Macro-f1: 0.6618, Weighted-f1: 0.7557, Loss: 0.8349
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4843, Macro-f1: 0.3313, Weighted-f1: 0.4458, Loss: 1.6208
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.6208 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8775, Macro-f1: 0.7852, Weighted-f1: 0.8669, Loss: 0.5359
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4952, Macro-f1: 0.3445, Weighted-f1: 0.4591, Loss: 1.5506
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5506 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9244, Macro-f1: 0.8611, Weighted-f1: 0.9164, Loss: 0.3641
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5043, Macro-f1: 0.3572, Weighted-f1: 0.4714, Loss: 1.5458
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5458 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9618, Macro-f1: 0.9319, Weighted-f1: 0.9594, Loss: 0.2403
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5119, Macro-f1: 0.3672, Weighted-f1: 0.4826, Loss: 1.5562
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9824, Macro-f1: 0.9651, Weighted-f1: 0.9810, Loss: 0.1562
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5181, Macro-f1: 0.3757, Weighted-f1: 0.4904, Loss: 1.6716
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9894, Macro-f1: 0.9779, Weighted-f1: 0.9887, Loss: 0.1049
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5232, Macro-f1: 0.3823, Weighted-f1: 0.4968, Loss: 1.6611
Saved models from epoch 8 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5458 loss). Early stop.
OOD training completed for test topic music after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be4be550> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be3a5d60> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3745, Macro-f1: 0.2222, Weighted-f1: 0.3175, Loss: 2.1090
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4542, Macro-f1: 0.3105, Weighted-f1: 0.4059, Loss: 1.8111
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.8111 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6993, Macro-f1: 0.5552, Weighted-f1: 0.6706, Loss: 1.1211
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4971, Macro-f1: 0.3483, Weighted-f1: 0.4576, Loss: 1.5371
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.5371 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8272, Macro-f1: 0.7196, Weighted-f1: 0.8106, Loss: 0.6916
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5194, Macro-f1: 0.3707, Weighted-f1: 0.4833, Loss: 1.4660
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4660 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9001, Macro-f1: 0.8279, Weighted-f1: 0.8900, Loss: 0.4325
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5360, Macro-f1: 0.3855, Weighted-f1: 0.5004, Loss: 1.4974
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9384, Macro-f1: 0.8805, Weighted-f1: 0.9314, Loss: 0.2839
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5487, Macro-f1: 0.3988, Weighted-f1: 0.5165, Loss: 1.4517
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4517 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9688, Macro-f1: 0.9437, Weighted-f1: 0.9658, Loss: 0.1805
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5595, Macro-f1: 0.4095, Weighted-f1: 0.5288, Loss: 1.5270
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9811, Macro-f1: 0.9609, Weighted-f1: 0.9794, Loss: 0.1189
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5665, Macro-f1: 0.4169, Weighted-f1: 0.5369, Loss: 1.6150
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9943, Macro-f1: 0.9912, Weighted-f1: 0.9939, Loss: 0.0809
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5717, Macro-f1: 0.4229, Weighted-f1: 0.5434, Loss: 1.6122
Saved models from epoch 8 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.4517 loss). Early stop.
OOD training completed for test topic news after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa6ffb75ac0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be4be880> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3528, Macro-f1: 0.2067, Weighted-f1: 0.3007, Loss: 2.1878
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4783, Macro-f1: 0.3005, Weighted-f1: 0.4259, Loss: 1.8408
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.8408 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6665, Macro-f1: 0.5105, Weighted-f1: 0.6293, Loss: 1.2315
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5129, Macro-f1: 0.3376, Weighted-f1: 0.4655, Loss: 1.5685
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.5685 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8199, Macro-f1: 0.7146, Weighted-f1: 0.8021, Loss: 0.7596
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5284, Macro-f1: 0.3572, Weighted-f1: 0.4878, Loss: 1.4917
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4917 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8915, Macro-f1: 0.8105, Weighted-f1: 0.8812, Loss: 0.4882
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5401, Macro-f1: 0.3732, Weighted-f1: 0.5042, Loss: 1.4262
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4262 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9415, Macro-f1: 0.9005, Weighted-f1: 0.9362, Loss: 0.3085
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5499, Macro-f1: 0.3832, Weighted-f1: 0.5158, Loss: 1.4111
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4111 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9756, Macro-f1: 0.9488, Weighted-f1: 0.9734, Loss: 0.1884
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5583, Macro-f1: 0.3923, Weighted-f1: 0.5255, Loss: 1.4170
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9892, Macro-f1: 0.9766, Weighted-f1: 0.9880, Loss: 0.1264
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5651, Macro-f1: 0.3997, Weighted-f1: 0.5337, Loss: 1.4494
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9938, Macro-f1: 0.9860, Weighted-f1: 0.9928, Loss: 0.0862
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5697, Macro-f1: 0.4052, Weighted-f1: 0.5386, Loss: 1.4660
Saved models from epoch 8 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.4111 loss). Early stop.
OOD training completed for test topic politics after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa5be48aac0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fa6ffb40a00> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data.
Read data from folder data/predictions/ood_clustering_data/9908/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3719, Macro-f1: 0.2048, Weighted-f1: 0.3041, Loss: 2.1274
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5248, Macro-f1: 0.3441, Weighted-f1: 0.4742, Loss: 1.6721
Saved models from epoch 1 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.6721 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6833, Macro-f1: 0.5428, Weighted-f1: 0.6478, Loss: 1.1742
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5353, Macro-f1: 0.3591, Weighted-f1: 0.4937, Loss: 1.5013
Saved models from epoch 2 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.5013 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8245, Macro-f1: 0.7163, Weighted-f1: 0.8070, Loss: 0.7336
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5496, Macro-f1: 0.3755, Weighted-f1: 0.5109, Loss: 1.3706
Saved models from epoch 3 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.3706 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8932, Macro-f1: 0.8221, Weighted-f1: 0.8807, Loss: 0.4689
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5611, Macro-f1: 0.3892, Weighted-f1: 0.5246, Loss: 1.3660
Saved models from epoch 4 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.3660 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9370, Macro-f1: 0.8769, Weighted-f1: 0.9300, Loss: 0.2989
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5683, Macro-f1: 0.3975, Weighted-f1: 0.5325, Loss: 1.4258
Saved models from epoch 5 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9693, Macro-f1: 0.9403, Weighted-f1: 0.9675, Loss: 0.1917
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5730, Macro-f1: 0.4028, Weighted-f1: 0.5374, Loss: 1.4437
Saved models from epoch 6 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9839, Macro-f1: 0.9689, Weighted-f1: 0.9827, Loss: 0.1278
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5783, Macro-f1: 0.4102, Weighted-f1: 0.5440, Loss: 1.4646
Saved models from epoch 7 to 'data/predictions/almnps_9908/ood_clustering/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3660 loss). Early stop.
OOD training completed for test topic science after 7 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		ood_clustering
