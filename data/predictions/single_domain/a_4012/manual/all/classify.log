Saved arguments to data/predictions/single_domain/a_4012/manual/all/args.json.
Saved category mapping to data/predictions/single_domain/a_4012/manual/all/entity2category_mapping.json.
Loaded category mapping: manual.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8128525f70> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f812852e670> (dev).
Starting training on ['ai'] data.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.2059, Macro-f1: 0.0895, Weighted-f1: 0.1470, Loss: 2.5530
[Epoch 1/50] Evaluation completed with Micro-f1: 0.2557, Macro-f1: 0.0692, Weighted-f1: 0.1506, Loss: 2.3159
Saved models from epoch 1 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 2.3159 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.4091, Macro-f1: 0.2095, Weighted-f1: 0.3266, Loss: 1.9922
[Epoch 2/50] Evaluation completed with Micro-f1: 0.2939, Macro-f1: 0.1176, Weighted-f1: 0.2077, Loss: 2.1074
Saved models from epoch 2 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 2.1074 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.6117, Macro-f1: 0.4068, Weighted-f1: 0.5510, Loss: 1.5071
[Epoch 3/50] Evaluation completed with Micro-f1: 0.3478, Macro-f1: 0.1675, Weighted-f1: 0.2705, Loss: 1.8663
Saved models from epoch 3 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.8663 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.7996, Macro-f1: 0.6706, Weighted-f1: 0.7780, Loss: 1.0942
[Epoch 4/50] Evaluation completed with Micro-f1: 0.3797, Macro-f1: 0.1974, Weighted-f1: 0.3090, Loss: 1.7553
Saved models from epoch 4 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.7553 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.8513, Macro-f1: 0.7607, Weighted-f1: 0.8281, Loss: 0.8185
[Epoch 5/50] Evaluation completed with Micro-f1: 0.3977, Macro-f1: 0.2165, Weighted-f1: 0.3334, Loss: 1.6853
Saved models from epoch 5 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.6853 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9167, Macro-f1: 0.8477, Weighted-f1: 0.9021, Loss: 0.6217
[Epoch 6/50] Evaluation completed with Micro-f1: 0.4135, Macro-f1: 0.2349, Weighted-f1: 0.3538, Loss: 1.6395
Saved models from epoch 6 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.6395 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9513, Macro-f1: 0.9144, Weighted-f1: 0.9412, Loss: 0.4677
[Epoch 7/50] Evaluation completed with Micro-f1: 0.4245, Macro-f1: 0.2494, Weighted-f1: 0.3695, Loss: 1.5927
Saved models from epoch 7 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.5927 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9688, Macro-f1: 0.9531, Weighted-f1: 0.9668, Loss: 0.3574
[Epoch 8/50] Evaluation completed with Micro-f1: 0.4317, Macro-f1: 0.2583, Weighted-f1: 0.3796, Loss: 1.5900
Saved models from epoch 8 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.5900 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 9/50] Train completed with Micro-f1: 0.9886, Macro-f1: 0.9706, Weighted-f1: 0.9849, Loss: 0.2757
[Epoch 9/50] Evaluation completed with Micro-f1: 0.4389, Macro-f1: 0.2684, Weighted-f1: 0.3901, Loss: 1.5936
Saved models from epoch 9 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
[Epoch 10/50] Train completed with Micro-f1: 0.9911, Macro-f1: 0.9862, Weighted-f1: 0.9895, Loss: 0.2078
[Epoch 10/50] Evaluation completed with Micro-f1: 0.4449, Macro-f1: 0.2766, Weighted-f1: 0.3981, Loss: 1.5626
Saved models from epoch 10 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.5626 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 11/50] Train completed with Micro-f1: 1.0000, Macro-f1: 1.0000, Weighted-f1: 1.0000, Loss: 0.1666
[Epoch 11/50] Evaluation completed with Micro-f1: 0.4501, Macro-f1: 0.2821, Weighted-f1: 0.4049, Loss: 1.5520
Saved models from epoch 11 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
Saved model with best loss 1.5520 to 'data/predictions/single_domain/a_4012/manual/all/best.pt'.
[Epoch 12/50] Train completed with Micro-f1: 0.9943, Macro-f1: 0.9879, Weighted-f1: 0.9927, Loss: 0.1341
[Epoch 12/50] Evaluation completed with Micro-f1: 0.4548, Macro-f1: 0.2889, Weighted-f1: 0.4114, Loss: 1.5691
Saved models from epoch 12 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
[Epoch 13/50] Train completed with Micro-f1: 1.0000, Macro-f1: 1.0000, Weighted-f1: 1.0000, Loss: 0.1053
[Epoch 13/50] Evaluation completed with Micro-f1: 0.4586, Macro-f1: 0.2938, Weighted-f1: 0.4162, Loss: 1.5847
Saved models from epoch 13 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
[Epoch 14/50] Train completed with Micro-f1: 0.9941, Macro-f1: 0.9965, Weighted-f1: 0.9941, Loss: 0.0912
[Epoch 14/50] Evaluation completed with Micro-f1: 0.4616, Macro-f1: 0.2969, Weighted-f1: 0.4209, Loss: 1.5916
Saved models from epoch 14 to 'data/predictions/single_domain/a_4012/manual/all/newest.pt'.
No improvement since 3 epochs (1.5520 loss). Early stop.
Training completed after 14 epochs.
TRAINING COMPLETED with:
	Domains:		['ai']
	OOD validaation:	False
	Mapping type:		manual
