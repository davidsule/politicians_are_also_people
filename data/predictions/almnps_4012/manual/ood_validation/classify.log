Saved arguments to data/predictions/almnps_4012/manual/ood_validation/args.json.
Saved category mapping to data/predictions/almnps_4012/manual/ood_validation/entity2category_mapping.json.
Loaded category mapping: manual.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e84cf10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e855550> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4404, Macro-f1: 0.2660, Weighted-f1: 0.3674, Loss: 1.9106
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5314, Macro-f1: 0.3472, Weighted-f1: 0.4855, Loss: 1.5914
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5914 to 'data/predictions/almnps_4012/manual/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7449, Macro-f1: 0.6013, Weighted-f1: 0.7133, Loss: 0.9569
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5518, Macro-f1: 0.3779, Weighted-f1: 0.5105, Loss: 1.4310
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4310 to 'data/predictions/almnps_4012/manual/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8544, Macro-f1: 0.7500, Weighted-f1: 0.8398, Loss: 0.5776
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5658, Macro-f1: 0.3971, Weighted-f1: 0.5283, Loss: 1.3925
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
Saved model with best loss 1.3925 to 'data/predictions/almnps_4012/manual/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9215, Macro-f1: 0.8609, Weighted-f1: 0.9148, Loss: 0.3539
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5739, Macro-f1: 0.4086, Weighted-f1: 0.5382, Loss: 1.4032
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9657, Macro-f1: 0.9366, Weighted-f1: 0.9635, Loss: 0.2081
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5806, Macro-f1: 0.4182, Weighted-f1: 0.5473, Loss: 1.4344
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9829, Macro-f1: 0.9672, Weighted-f1: 0.9803, Loss: 0.1355
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5854, Macro-f1: 0.4244, Weighted-f1: 0.5546, Loss: 1.5584
Saved models from epoch 6 to 'data/predictions/almnps_4012/manual/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.3925 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8330601760> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e8550d0> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4018, Macro-f1: 0.2451, Weighted-f1: 0.3298, Loss: 2.0359
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5110, Macro-f1: 0.3564, Weighted-f1: 0.4748, Loss: 1.6457
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.6457 to 'data/predictions/almnps_4012/manual/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7321, Macro-f1: 0.6195, Weighted-f1: 0.7096, Loss: 1.0260
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5312, Macro-f1: 0.3815, Weighted-f1: 0.5001, Loss: 1.4416
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4416 to 'data/predictions/almnps_4012/manual/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8397, Macro-f1: 0.7416, Weighted-f1: 0.8297, Loss: 0.6175
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5452, Macro-f1: 0.3978, Weighted-f1: 0.5188, Loss: 1.4205
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4205 to 'data/predictions/almnps_4012/manual/ood_validation/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9087, Macro-f1: 0.8534, Weighted-f1: 0.9047, Loss: 0.3966
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5541, Macro-f1: 0.4093, Weighted-f1: 0.5301, Loss: 1.4370
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9400, Macro-f1: 0.9071, Weighted-f1: 0.9362, Loss: 0.2846
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5585, Macro-f1: 0.4133, Weighted-f1: 0.5358, Loss: 1.4505
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9721, Macro-f1: 0.9509, Weighted-f1: 0.9711, Loss: 0.1717
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5646, Macro-f1: 0.4205, Weighted-f1: 0.5433, Loss: 1.4530
Saved models from epoch 6 to 'data/predictions/almnps_4012/manual/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4205 loss). Early stop.
OOD training completed for test topic literature after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e630820> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f833031bdc0> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3744, Macro-f1: 0.2291, Weighted-f1: 0.3088, Loss: 2.1054
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4598, Macro-f1: 0.2998, Weighted-f1: 0.4106, Loss: 1.8339
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.8339 to 'data/predictions/almnps_4012/manual/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6976, Macro-f1: 0.5677, Weighted-f1: 0.6738, Loss: 1.1252
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4858, Macro-f1: 0.3320, Weighted-f1: 0.4458, Loss: 1.6064
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.6064 to 'data/predictions/almnps_4012/manual/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8360, Macro-f1: 0.7480, Weighted-f1: 0.8184, Loss: 0.6754
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4993, Macro-f1: 0.3484, Weighted-f1: 0.4640, Loss: 1.5235
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.5235 to 'data/predictions/almnps_4012/manual/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9228, Macro-f1: 0.8753, Weighted-f1: 0.9146, Loss: 0.4097
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5100, Macro-f1: 0.3619, Weighted-f1: 0.4770, Loss: 1.5054
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
Saved model with best loss 1.5054 to 'data/predictions/almnps_4012/manual/ood_validation/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9644, Macro-f1: 0.9395, Weighted-f1: 0.9613, Loss: 0.2510
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5181, Macro-f1: 0.3734, Weighted-f1: 0.4884, Loss: 1.5104
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9771, Macro-f1: 0.9562, Weighted-f1: 0.9748, Loss: 0.1619
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5245, Macro-f1: 0.3822, Weighted-f1: 0.4969, Loss: 1.5492
Saved models from epoch 6 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9922, Macro-f1: 0.9846, Weighted-f1: 0.9921, Loss: 0.1034
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5282, Macro-f1: 0.3858, Weighted-f1: 0.5011, Loss: 1.6184
Saved models from epoch 7 to 'data/predictions/almnps_4012/manual/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5054 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e519130> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832bd557c0> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4431, Macro-f1: 0.2844, Weighted-f1: 0.3808, Loss: 1.9483
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5306, Macro-f1: 0.3735, Weighted-f1: 0.4939, Loss: 1.5477
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.5477 to 'data/predictions/almnps_4012/manual/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7461, Macro-f1: 0.6190, Weighted-f1: 0.7247, Loss: 0.9626
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5555, Macro-f1: 0.4000, Weighted-f1: 0.5230, Loss: 1.3942
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.3942 to 'data/predictions/almnps_4012/manual/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8595, Macro-f1: 0.7878, Weighted-f1: 0.8501, Loss: 0.5759
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5686, Macro-f1: 0.4157, Weighted-f1: 0.5394, Loss: 1.3744
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
Saved model with best loss 1.3744 to 'data/predictions/almnps_4012/manual/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9262, Macro-f1: 0.8842, Weighted-f1: 0.9194, Loss: 0.3529
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5765, Macro-f1: 0.4254, Weighted-f1: 0.5482, Loss: 1.3746
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9552, Macro-f1: 0.9269, Weighted-f1: 0.9528, Loss: 0.2203
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5820, Macro-f1: 0.4314, Weighted-f1: 0.5557, Loss: 1.4046
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9757, Macro-f1: 0.9567, Weighted-f1: 0.9738, Loss: 0.1383
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5871, Macro-f1: 0.4368, Weighted-f1: 0.5631, Loss: 1.4218
Saved models from epoch 6 to 'data/predictions/almnps_4012/manual/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.3744 loss). Early stop.
OOD training completed for test topic news after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e748100> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e4fbee0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4013, Macro-f1: 0.2570, Weighted-f1: 0.3463, Loss: 2.0679
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5294, Macro-f1: 0.3539, Weighted-f1: 0.4845, Loss: 1.6614
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.6614 to 'data/predictions/almnps_4012/manual/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7275, Macro-f1: 0.5973, Weighted-f1: 0.6961, Loss: 1.0701
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5503, Macro-f1: 0.3786, Weighted-f1: 0.5123, Loss: 1.4146
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4146 to 'data/predictions/almnps_4012/manual/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8391, Macro-f1: 0.7441, Weighted-f1: 0.8264, Loss: 0.6614
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5650, Macro-f1: 0.3982, Weighted-f1: 0.5314, Loss: 1.3264
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3264 to 'data/predictions/almnps_4012/manual/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9067, Macro-f1: 0.8401, Weighted-f1: 0.8977, Loss: 0.4130
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5789, Macro-f1: 0.4138, Weighted-f1: 0.5482, Loss: 1.2944
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
Saved model with best loss 1.2944 to 'data/predictions/almnps_4012/manual/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9525, Macro-f1: 0.9146, Weighted-f1: 0.9506, Loss: 0.2605
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5863, Macro-f1: 0.4218, Weighted-f1: 0.5573, Loss: 1.3521
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9778, Macro-f1: 0.9534, Weighted-f1: 0.9768, Loss: 0.1621
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5926, Macro-f1: 0.4280, Weighted-f1: 0.5648, Loss: 1.3808
Saved models from epoch 6 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9876, Macro-f1: 0.9803, Weighted-f1: 0.9867, Loss: 0.1078
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5969, Macro-f1: 0.4327, Weighted-f1: 0.5691, Loss: 1.4157
Saved models from epoch 7 to 'data/predictions/almnps_4012/manual/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.2944 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f831216abb0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f832e7489d0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4198, Macro-f1: 0.2545, Weighted-f1: 0.3626, Loss: 1.9789
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5570, Macro-f1: 0.3879, Weighted-f1: 0.5142, Loss: 1.5466
Saved models from epoch 1 to 'data/predictions/almnps_4012/manual/ood_validation/science/newest.pt'.
Saved model with best loss 1.5466 to 'data/predictions/almnps_4012/manual/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7171, Macro-f1: 0.5787, Weighted-f1: 0.6932, Loss: 1.0368
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5726, Macro-f1: 0.4062, Weighted-f1: 0.5346, Loss: 1.4118
Saved models from epoch 2 to 'data/predictions/almnps_4012/manual/ood_validation/science/newest.pt'.
Saved model with best loss 1.4118 to 'data/predictions/almnps_4012/manual/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8352, Macro-f1: 0.7264, Weighted-f1: 0.8207, Loss: 0.6351
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5814, Macro-f1: 0.4172, Weighted-f1: 0.5479, Loss: 1.4537
Saved models from epoch 3 to 'data/predictions/almnps_4012/manual/ood_validation/science/newest.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9048, Macro-f1: 0.8332, Weighted-f1: 0.8955, Loss: 0.4050
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5881, Macro-f1: 0.4259, Weighted-f1: 0.5567, Loss: 1.4820
Saved models from epoch 4 to 'data/predictions/almnps_4012/manual/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9462, Macro-f1: 0.8954, Weighted-f1: 0.9409, Loss: 0.2497
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5938, Macro-f1: 0.4300, Weighted-f1: 0.5626, Loss: 1.4650
Saved models from epoch 5 to 'data/predictions/almnps_4012/manual/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.4118 loss). Early stop.
OOD training completed for test topic science after 5 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		manual
