Saved arguments to data/predictions/almnps_4012/embedding/ood/args.json.
loading projection weights from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz
KeyedVectors lifecycle event {'msg': 'loaded (3000000, 300) matrix of type float32 from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz', 'binary': True, 'encoding': 'utf8', 'datetime': '2023-05-07T04:38:28.255382', 'gensim': '4.3.0', 'python': '3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) \n[GCC 11.3.0]', 'platform': 'Linux-5.15.90.1-microsoft-standard-WSL2-x86_64-with-glibc2.31', 'event': 'load_word2vec_format'}
Saved category mapping to data/predictions/almnps_4012/embedding/ood/mapping.json.
Loaded category mapping: embedding.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafdc3a2fa0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafdc3a2ac0> (dev).
Starting training on literature data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3996, Macro-f1: 0.2175, Weighted-f1: 0.3240, Loss: 2.0523
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5043, Macro-f1: 0.3257, Weighted-f1: 0.4503, Loss: 1.7694
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
Saved model with best loss 1.7694 to 'data/predictions/almnps_4012/embedding/ood/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7054, Macro-f1: 0.5473, Weighted-f1: 0.6716, Loss: 1.1043
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5298, Macro-f1: 0.3547, Weighted-f1: 0.4798, Loss: 1.5538
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
Saved model with best loss 1.5538 to 'data/predictions/almnps_4012/embedding/ood/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8289, Macro-f1: 0.7285, Weighted-f1: 0.8131, Loss: 0.6701
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5441, Macro-f1: 0.3688, Weighted-f1: 0.4957, Loss: 1.4701
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
Saved model with best loss 1.4701 to 'data/predictions/almnps_4012/embedding/ood/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8965, Macro-f1: 0.8084, Weighted-f1: 0.8864, Loss: 0.4391
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5539, Macro-f1: 0.3803, Weighted-f1: 0.5076, Loss: 1.5003
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9447, Macro-f1: 0.8923, Weighted-f1: 0.9381, Loss: 0.2696
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5619, Macro-f1: 0.3922, Weighted-f1: 0.5196, Loss: 1.5176
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9805, Macro-f1: 0.9596, Weighted-f1: 0.9787, Loss: 0.1643
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5680, Macro-f1: 0.4005, Weighted-f1: 0.5280, Loss: 1.5727
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/ai/newest.pt'.
No improvement since 3 epochs (1.4701 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faf51de9fd0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafdc3a2460> (dev).
Starting training on ai data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3641, Macro-f1: 0.2047, Weighted-f1: 0.3027, Loss: 2.1281
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4840, Macro-f1: 0.3032, Weighted-f1: 0.4274, Loss: 1.7748
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
Saved model with best loss 1.7748 to 'data/predictions/almnps_4012/embedding/ood/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6594, Macro-f1: 0.5203, Weighted-f1: 0.6304, Loss: 1.1873
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5048, Macro-f1: 0.3334, Weighted-f1: 0.4553, Loss: 1.5515
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
Saved model with best loss 1.5515 to 'data/predictions/almnps_4012/embedding/ood/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8189, Macro-f1: 0.7174, Weighted-f1: 0.8016, Loss: 0.7184
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5191, Macro-f1: 0.3542, Weighted-f1: 0.4769, Loss: 1.4704
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
Saved model with best loss 1.4704 to 'data/predictions/almnps_4012/embedding/ood/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8985, Macro-f1: 0.8364, Weighted-f1: 0.8925, Loss: 0.4595
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5291, Macro-f1: 0.3685, Weighted-f1: 0.4928, Loss: 1.5332
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9459, Macro-f1: 0.8968, Weighted-f1: 0.9421, Loss: 0.2906
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5365, Macro-f1: 0.3798, Weighted-f1: 0.5043, Loss: 1.5455
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9735, Macro-f1: 0.9524, Weighted-f1: 0.9706, Loss: 0.1822
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5432, Macro-f1: 0.3884, Weighted-f1: 0.5131, Loss: 1.5333
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/literature/newest.pt'.
No improvement since 3 epochs (1.4704 loss). Early stop.
OOD training completed for test topic literature after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca5f4f10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faf51dc3790> (dev).
Starting training on ai data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3193, Macro-f1: 0.1716, Weighted-f1: 0.2474, Loss: 2.2473
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4322, Macro-f1: 0.2814, Weighted-f1: 0.3895, Loss: 1.9609
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
Saved model with best loss 1.9609 to 'data/predictions/almnps_4012/embedding/ood/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6640, Macro-f1: 0.5128, Weighted-f1: 0.6252, Loss: 1.2922
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4663, Macro-f1: 0.3148, Weighted-f1: 0.4288, Loss: 1.6654
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
Saved model with best loss 1.6654 to 'data/predictions/almnps_4012/embedding/ood/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.7956, Macro-f1: 0.6850, Weighted-f1: 0.7717, Loss: 0.8092
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4843, Macro-f1: 0.3369, Weighted-f1: 0.4489, Loss: 1.6188
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
Saved model with best loss 1.6188 to 'data/predictions/almnps_4012/embedding/ood/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8880, Macro-f1: 0.8161, Weighted-f1: 0.8784, Loss: 0.5148
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4976, Macro-f1: 0.3526, Weighted-f1: 0.4653, Loss: 1.5202
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
Saved model with best loss 1.5202 to 'data/predictions/almnps_4012/embedding/ood/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9339, Macro-f1: 0.8881, Weighted-f1: 0.9269, Loss: 0.3337
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5064, Macro-f1: 0.3630, Weighted-f1: 0.4773, Loss: 1.5512
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9715, Macro-f1: 0.9536, Weighted-f1: 0.9692, Loss: 0.2181
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5144, Macro-f1: 0.3710, Weighted-f1: 0.4872, Loss: 1.5548
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9846, Macro-f1: 0.9703, Weighted-f1: 0.9826, Loss: 0.1501
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5206, Macro-f1: 0.3783, Weighted-f1: 0.4942, Loss: 1.6329
Saved models from epoch 7 to 'data/predictions/almnps_4012/embedding/ood/music/newest.pt'.
No improvement since 3 epochs (1.5202 loss). Early stop.
OOD training completed for test topic music after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca45e760> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca47eeb0> (dev).
Starting training on ai data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3805, Macro-f1: 0.2207, Weighted-f1: 0.3223, Loss: 2.1021
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5130, Macro-f1: 0.3430, Weighted-f1: 0.4683, Loss: 1.7160
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
Saved model with best loss 1.7160 to 'data/predictions/almnps_4012/embedding/ood/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7127, Macro-f1: 0.5688, Weighted-f1: 0.6817, Loss: 1.0849
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5325, Macro-f1: 0.3685, Weighted-f1: 0.4917, Loss: 1.4881
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
Saved model with best loss 1.4881 to 'data/predictions/almnps_4012/embedding/ood/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8371, Macro-f1: 0.7363, Weighted-f1: 0.8219, Loss: 0.6436
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5447, Macro-f1: 0.3830, Weighted-f1: 0.5072, Loss: 1.4163
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
Saved model with best loss 1.4163 to 'data/predictions/almnps_4012/embedding/ood/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9181, Macro-f1: 0.8636, Weighted-f1: 0.9125, Loss: 0.3880
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5559, Macro-f1: 0.3978, Weighted-f1: 0.5234, Loss: 1.3840
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
Saved model with best loss 1.3840 to 'data/predictions/almnps_4012/embedding/ood/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9520, Macro-f1: 0.9061, Weighted-f1: 0.9458, Loss: 0.2529
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5655, Macro-f1: 0.4094, Weighted-f1: 0.5350, Loss: 1.4417
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9811, Macro-f1: 0.9625, Weighted-f1: 0.9803, Loss: 0.1531
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5721, Macro-f1: 0.4169, Weighted-f1: 0.5430, Loss: 1.4921
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9934, Macro-f1: 0.9846, Weighted-f1: 0.9929, Loss: 0.0943
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5775, Macro-f1: 0.4228, Weighted-f1: 0.5490, Loss: 1.5040
Saved models from epoch 7 to 'data/predictions/almnps_4012/embedding/ood/news/newest.pt'.
No improvement since 3 epochs (1.3840 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca6196a0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca45e310> (dev).
Starting training on ai data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3488, Macro-f1: 0.2016, Weighted-f1: 0.2953, Loss: 2.1799
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4622, Macro-f1: 0.2904, Weighted-f1: 0.4135, Loss: 1.8212
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
Saved model with best loss 1.8212 to 'data/predictions/almnps_4012/embedding/ood/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6566, Macro-f1: 0.5041, Weighted-f1: 0.6215, Loss: 1.2469
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4963, Macro-f1: 0.3199, Weighted-f1: 0.4515, Loss: 1.5354
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
Saved model with best loss 1.5354 to 'data/predictions/almnps_4012/embedding/ood/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8069, Macro-f1: 0.7041, Weighted-f1: 0.7923, Loss: 0.7997
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5205, Macro-f1: 0.3497, Weighted-f1: 0.4800, Loss: 1.4362
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
Saved model with best loss 1.4362 to 'data/predictions/almnps_4012/embedding/ood/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8880, Macro-f1: 0.8048, Weighted-f1: 0.8788, Loss: 0.5101
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5357, Macro-f1: 0.3686, Weighted-f1: 0.5002, Loss: 1.4011
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
Saved model with best loss 1.4011 to 'data/predictions/almnps_4012/embedding/ood/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9332, Macro-f1: 0.8911, Weighted-f1: 0.9274, Loss: 0.3375
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5475, Macro-f1: 0.3840, Weighted-f1: 0.5158, Loss: 1.4145
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9632, Macro-f1: 0.9283, Weighted-f1: 0.9618, Loss: 0.2227
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5554, Macro-f1: 0.3926, Weighted-f1: 0.5243, Loss: 1.4533
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9827, Macro-f1: 0.9650, Weighted-f1: 0.9824, Loss: 0.1441
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5610, Macro-f1: 0.3999, Weighted-f1: 0.5315, Loss: 1.4812
Saved models from epoch 7 to 'data/predictions/almnps_4012/embedding/ood/politics/newest.pt'.
No improvement since 3 epochs (1.4011 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7faf6a4f4eb0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fafca6196a0> (dev).
Starting training on ai data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3867, Macro-f1: 0.2159, Weighted-f1: 0.3154, Loss: 2.0959
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5060, Macro-f1: 0.3294, Weighted-f1: 0.4619, Loss: 1.7295
Saved models from epoch 1 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
Saved model with best loss 1.7295 to 'data/predictions/almnps_4012/embedding/ood/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6779, Macro-f1: 0.5207, Weighted-f1: 0.6390, Loss: 1.1866
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5274, Macro-f1: 0.3548, Weighted-f1: 0.4869, Loss: 1.5529
Saved models from epoch 2 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
Saved model with best loss 1.5529 to 'data/predictions/almnps_4012/embedding/ood/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8197, Macro-f1: 0.7132, Weighted-f1: 0.7989, Loss: 0.7332
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5408, Macro-f1: 0.3720, Weighted-f1: 0.5049, Loss: 1.5020
Saved models from epoch 3 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
Saved model with best loss 1.5020 to 'data/predictions/almnps_4012/embedding/ood/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8807, Macro-f1: 0.8036, Weighted-f1: 0.8689, Loss: 0.4791
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5525, Macro-f1: 0.3885, Weighted-f1: 0.5194, Loss: 1.4791
Saved models from epoch 4 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
Saved model with best loss 1.4791 to 'data/predictions/almnps_4012/embedding/ood/science/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9338, Macro-f1: 0.8766, Weighted-f1: 0.9307, Loss: 0.3042
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5610, Macro-f1: 0.3995, Weighted-f1: 0.5296, Loss: 1.5318
Saved models from epoch 5 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9776, Macro-f1: 0.9607, Weighted-f1: 0.9762, Loss: 0.1893
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5678, Macro-f1: 0.4076, Weighted-f1: 0.5382, Loss: 1.6172
Saved models from epoch 6 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9885, Macro-f1: 0.9746, Weighted-f1: 0.9877, Loss: 0.1195
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5731, Macro-f1: 0.4141, Weighted-f1: 0.5448, Loss: 1.5999
Saved models from epoch 7 to 'data/predictions/almnps_4012/embedding/ood/science/newest.pt'.
No improvement since 3 epochs (1.4791 loss). Early stop.
OOD training completed for test topic science after 7 epochs.
