Saved arguments to data/predictions/almnps_4012/ood_clustering/ood_validation/args.json.
Out of domain clustering of entities with domain-specific unique entities created and saved to: data/predictions/ood_clustering_data/4012/
loading projection weights from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz
KeyedVectors lifecycle event {'msg': 'loaded (3000000, 300) matrix of type float32 from /home/davidsule/gensim-data/word2vec-google-news-300/word2vec-google-news-300.gz', 'binary': True, 'encoding': 'utf8', 'datetime': '2023-05-13T23:45:41.375947', 'gensim': '4.3.0', 'python': '3.9.16 | packaged by conda-forge | (main, Feb  1 2023, 21:39:03) \n[GCC 11.3.0]', 'platform': 'Linux-5.15.90.1-microsoft-standard-WSL2-x86_64-with-glibc2.31', 'event': 'load_word2vec_format'}
Saved category mapping to data/predictions/almnps_4012/ood_clustering/ood_validation/entity2category_mapping.json.
Loaded category mapping: ood_clustering.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e63aa910> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e63aa790> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4069, Macro-f1: 0.2295, Weighted-f1: 0.3306, Loss: 2.0160
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5026, Macro-f1: 0.3249, Weighted-f1: 0.4488, Loss: 1.7418
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.7418 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7178, Macro-f1: 0.5574, Weighted-f1: 0.6847, Loss: 1.0437
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5266, Macro-f1: 0.3556, Weighted-f1: 0.4789, Loss: 1.5322
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5322 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8530, Macro-f1: 0.7595, Weighted-f1: 0.8405, Loss: 0.6017
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5390, Macro-f1: 0.3700, Weighted-f1: 0.4923, Loss: 1.4932
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4932 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9158, Macro-f1: 0.8507, Weighted-f1: 0.9069, Loss: 0.3677
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5504, Macro-f1: 0.3857, Weighted-f1: 0.5096, Loss: 1.4308
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4308 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9631, Macro-f1: 0.9372, Weighted-f1: 0.9599, Loss: 0.2223
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5588, Macro-f1: 0.3956, Weighted-f1: 0.5207, Loss: 1.4595
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9813, Macro-f1: 0.9599, Weighted-f1: 0.9785, Loss: 0.1370
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5650, Macro-f1: 0.4025, Weighted-f1: 0.5284, Loss: 1.4633
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9906, Macro-f1: 0.9760, Weighted-f1: 0.9902, Loss: 0.0805
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5714, Macro-f1: 0.4104, Weighted-f1: 0.5365, Loss: 1.5596
Saved models from epoch 7 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4308 loss). Early stop.
OOD training completed for test topic ai after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc239d14880> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e71f7a30> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4014, Macro-f1: 0.2334, Weighted-f1: 0.3306, Loss: 2.0222
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5030, Macro-f1: 0.3392, Weighted-f1: 0.4610, Loss: 1.6823
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.6823 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7048, Macro-f1: 0.5611, Weighted-f1: 0.6755, Loss: 1.0748
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5226, Macro-f1: 0.3660, Weighted-f1: 0.4875, Loss: 1.5274
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.5274 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8449, Macro-f1: 0.7477, Weighted-f1: 0.8333, Loss: 0.6470
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5331, Macro-f1: 0.3807, Weighted-f1: 0.5017, Loss: 1.4681
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4681 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9096, Macro-f1: 0.8411, Weighted-f1: 0.9020, Loss: 0.3978
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5454, Macro-f1: 0.3951, Weighted-f1: 0.5165, Loss: 1.4007
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4007 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9551, Macro-f1: 0.9177, Weighted-f1: 0.9507, Loss: 0.2448
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5533, Macro-f1: 0.4026, Weighted-f1: 0.5253, Loss: 1.4654
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9781, Macro-f1: 0.9586, Weighted-f1: 0.9776, Loss: 0.1505
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5594, Macro-f1: 0.4112, Weighted-f1: 0.5326, Loss: 1.5141
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9941, Macro-f1: 0.9903, Weighted-f1: 0.9949, Loss: 0.0913
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5644, Macro-f1: 0.4178, Weighted-f1: 0.5383, Loss: 1.6127
Saved models from epoch 7 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4007 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e71800a0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e71f7190> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3513, Macro-f1: 0.2110, Weighted-f1: 0.2777, Loss: 2.1471
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4528, Macro-f1: 0.3108, Weighted-f1: 0.4240, Loss: 1.8621
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.8621 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6802, Macro-f1: 0.5515, Weighted-f1: 0.6498, Loss: 1.1883
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4746, Macro-f1: 0.3270, Weighted-f1: 0.4450, Loss: 1.6465
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.6465 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8322, Macro-f1: 0.7211, Weighted-f1: 0.8181, Loss: 0.7053
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4892, Macro-f1: 0.3406, Weighted-f1: 0.4603, Loss: 1.5771
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5771 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9093, Macro-f1: 0.8482, Weighted-f1: 0.9001, Loss: 0.4353
[Epoch 4/50] Evaluation completed with Micro-f1: 0.4999, Macro-f1: 0.3508, Weighted-f1: 0.4711, Loss: 1.5557
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5557 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9504, Macro-f1: 0.9209, Weighted-f1: 0.9465, Loss: 0.2720
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5089, Macro-f1: 0.3632, Weighted-f1: 0.4822, Loss: 1.5302
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
Saved model with best loss 1.5302 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9780, Macro-f1: 0.9564, Weighted-f1: 0.9768, Loss: 0.1679
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5152, Macro-f1: 0.3713, Weighted-f1: 0.4902, Loss: 1.5694
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9932, Macro-f1: 0.9855, Weighted-f1: 0.9918, Loss: 0.1024
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5204, Macro-f1: 0.3781, Weighted-f1: 0.4979, Loss: 1.6178
Saved models from epoch 7 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9955, Macro-f1: 0.9915, Weighted-f1: 0.9956, Loss: 0.0672
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5249, Macro-f1: 0.3834, Weighted-f1: 0.5029, Loss: 1.6452
Saved models from epoch 8 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5302 loss). Early stop.
OOD training completed for test topic music after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc1d0a4c5e0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc1d0782c70> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4051, Macro-f1: 0.2533, Weighted-f1: 0.3477, Loss: 2.0113
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4806, Macro-f1: 0.3282, Weighted-f1: 0.4349, Loss: 1.7113
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.7113 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7116, Macro-f1: 0.5820, Weighted-f1: 0.6852, Loss: 1.0583
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5097, Macro-f1: 0.3519, Weighted-f1: 0.4663, Loss: 1.5191
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.5191 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8476, Macro-f1: 0.7559, Weighted-f1: 0.8327, Loss: 0.6237
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5286, Macro-f1: 0.3728, Weighted-f1: 0.4914, Loss: 1.4321
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4321 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9214, Macro-f1: 0.8558, Weighted-f1: 0.9137, Loss: 0.3725
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5424, Macro-f1: 0.3883, Weighted-f1: 0.5077, Loss: 1.4188
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4188 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9626, Macro-f1: 0.9301, Weighted-f1: 0.9601, Loss: 0.2208
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5527, Macro-f1: 0.4001, Weighted-f1: 0.5208, Loss: 1.4083
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
Saved model with best loss 1.4083 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9829, Macro-f1: 0.9668, Weighted-f1: 0.9815, Loss: 0.1412
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5593, Macro-f1: 0.4066, Weighted-f1: 0.5282, Loss: 1.5027
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9957, Macro-f1: 0.9942, Weighted-f1: 0.9953, Loss: 0.0890
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5651, Macro-f1: 0.4127, Weighted-f1: 0.5349, Loss: 1.5306
Saved models from epoch 7 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9976, Macro-f1: 0.9959, Weighted-f1: 0.9974, Loss: 0.0574
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5697, Macro-f1: 0.4174, Weighted-f1: 0.5409, Loss: 1.5263
Saved models from epoch 8 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.4083 loss). Early stop.
OOD training completed for test topic news after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc230598f10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc242be8340> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3879, Macro-f1: 0.2426, Weighted-f1: 0.3311, Loss: 2.0816
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4613, Macro-f1: 0.3113, Weighted-f1: 0.4159, Loss: 1.7456
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.7456 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6978, Macro-f1: 0.5638, Weighted-f1: 0.6681, Loss: 1.1321
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4946, Macro-f1: 0.3394, Weighted-f1: 0.4515, Loss: 1.5309
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.5309 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8201, Macro-f1: 0.7132, Weighted-f1: 0.8050, Loss: 0.7133
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5180, Macro-f1: 0.3615, Weighted-f1: 0.4794, Loss: 1.4185
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4185 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8978, Macro-f1: 0.8205, Weighted-f1: 0.8903, Loss: 0.4456
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5348, Macro-f1: 0.3782, Weighted-f1: 0.5000, Loss: 1.3631
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3631 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9537, Macro-f1: 0.9133, Weighted-f1: 0.9519, Loss: 0.2741
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5451, Macro-f1: 0.3876, Weighted-f1: 0.5120, Loss: 1.4656
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9713, Macro-f1: 0.9436, Weighted-f1: 0.9694, Loss: 0.1791
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5547, Macro-f1: 0.3979, Weighted-f1: 0.5240, Loss: 1.3855
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9876, Macro-f1: 0.9767, Weighted-f1: 0.9870, Loss: 0.1119
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5615, Macro-f1: 0.4057, Weighted-f1: 0.5315, Loss: 1.4593
Saved models from epoch 7 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.3631 loss). Early stop.
OOD training completed for test topic politics after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e6fbb400> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7fc0e6fb52b0> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/predictions/ood_clustering_data/4012/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4111, Macro-f1: 0.2536, Weighted-f1: 0.3482, Loss: 2.0105
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5221, Macro-f1: 0.3574, Weighted-f1: 0.4809, Loss: 1.6370
Saved models from epoch 1 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.6370 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7087, Macro-f1: 0.5676, Weighted-f1: 0.6795, Loss: 1.0653
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5442, Macro-f1: 0.3813, Weighted-f1: 0.5082, Loss: 1.4310
Saved models from epoch 2 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.4310 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8351, Macro-f1: 0.7349, Weighted-f1: 0.8177, Loss: 0.6451
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5562, Macro-f1: 0.3967, Weighted-f1: 0.5249, Loss: 1.3627
Saved models from epoch 3 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
Saved model with best loss 1.3627 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9102, Macro-f1: 0.8408, Weighted-f1: 0.9053, Loss: 0.4114
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5637, Macro-f1: 0.4051, Weighted-f1: 0.5343, Loss: 1.3714
Saved models from epoch 4 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9496, Macro-f1: 0.9170, Weighted-f1: 0.9468, Loss: 0.2590
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5705, Macro-f1: 0.4140, Weighted-f1: 0.5421, Loss: 1.4208
Saved models from epoch 5 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9767, Macro-f1: 0.9608, Weighted-f1: 0.9760, Loss: 0.1613
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5757, Macro-f1: 0.4204, Weighted-f1: 0.5479, Loss: 1.4632
Saved models from epoch 6 to 'data/predictions/almnps_4012/ood_clustering/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3627 loss). Early stop.
OOD training completed for test topic science after 6 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		ood_clustering
