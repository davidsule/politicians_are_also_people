Saved arguments to data/predictions/almnps_4012/no_mapping/ood_validation/args.json.
Saved category mapping to data/predictions/almnps_4012/no_mapping/ood_validation/entity2category_mapping.json.
Loaded category mapping: no_mapping.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1cc2f10> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1ccb550> (dev).
Starting training on ['literature', 'music', 'news', 'politics', 'science'] data with validation domain ai.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3899, Macro-f1: 0.2167, Weighted-f1: 0.3155, Loss: 2.0704
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4800, Macro-f1: 0.3103, Weighted-f1: 0.4183, Loss: 1.8074
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
Saved model with best loss 1.8074 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7178, Macro-f1: 0.5542, Weighted-f1: 0.6806, Loss: 1.0487
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5181, Macro-f1: 0.3523, Weighted-f1: 0.4681, Loss: 1.5538
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
Saved model with best loss 1.5538 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8498, Macro-f1: 0.7542, Weighted-f1: 0.8346, Loss: 0.6016
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5374, Macro-f1: 0.3735, Weighted-f1: 0.4940, Loss: 1.4259
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
Saved model with best loss 1.4259 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9293, Macro-f1: 0.8698, Weighted-f1: 0.9225, Loss: 0.3498
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5531, Macro-f1: 0.3907, Weighted-f1: 0.5125, Loss: 1.4293
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9688, Macro-f1: 0.9405, Weighted-f1: 0.9660, Loss: 0.2021
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5637, Macro-f1: 0.4016, Weighted-f1: 0.5256, Loss: 1.4338
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9860, Macro-f1: 0.9723, Weighted-f1: 0.9844, Loss: 0.1224
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5723, Macro-f1: 0.4119, Weighted-f1: 0.5364, Loss: 1.4556
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/ai/newest.pt'.
No improvement since 3 epochs (1.4259 loss). Early stop.
OOD training completed for test topic ai after 6 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca379fc70> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1ccb0d0> (dev).
Starting training on ['ai', 'music', 'news', 'politics', 'science'] data with validation domain literature.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4200, Macro-f1: 0.2716, Weighted-f1: 0.3643, Loss: 2.0216
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5190, Macro-f1: 0.3621, Weighted-f1: 0.4812, Loss: 1.7039
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
Saved model with best loss 1.7039 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7347, Macro-f1: 0.6131, Weighted-f1: 0.7125, Loss: 1.0351
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5328, Macro-f1: 0.3749, Weighted-f1: 0.4944, Loss: 1.5432
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
Saved model with best loss 1.5432 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8589, Macro-f1: 0.7693, Weighted-f1: 0.8468, Loss: 0.5915
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5445, Macro-f1: 0.3919, Weighted-f1: 0.5093, Loss: 1.4416
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4416 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9268, Macro-f1: 0.8638, Weighted-f1: 0.9200, Loss: 0.3625
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5536, Macro-f1: 0.4036, Weighted-f1: 0.5213, Loss: 1.4285
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
Saved model with best loss 1.4285 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9705, Macro-f1: 0.9463, Weighted-f1: 0.9679, Loss: 0.2061
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5603, Macro-f1: 0.4109, Weighted-f1: 0.5295, Loss: 1.5007
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9858, Macro-f1: 0.9774, Weighted-f1: 0.9850, Loss: 0.1456
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5649, Macro-f1: 0.4159, Weighted-f1: 0.5351, Loss: 1.5314
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9942, Macro-f1: 0.9915, Weighted-f1: 0.9937, Loss: 0.0887
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5689, Macro-f1: 0.4207, Weighted-f1: 0.5399, Loss: 1.5660
Saved models from epoch 7 to 'data/predictions/almnps_4012/no_mapping/ood_validation/literature/newest.pt'.
No improvement since 3 epochs (1.4285 loss). Early stop.
OOD training completed for test topic literature after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1a6ceb0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca36f6190> (dev).
Starting training on ['ai', 'literature', 'news', 'politics', 'science'] data with validation domain music.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3454, Macro-f1: 0.2061, Weighted-f1: 0.2748, Loss: 2.2023
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4652, Macro-f1: 0.3018, Weighted-f1: 0.4179, Loss: 1.8990
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
Saved model with best loss 1.8990 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6806, Macro-f1: 0.5591, Weighted-f1: 0.6493, Loss: 1.2010
[Epoch 2/50] Evaluation completed with Micro-f1: 0.4876, Macro-f1: 0.3273, Weighted-f1: 0.4433, Loss: 1.6827
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
Saved model with best loss 1.6827 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8026, Macro-f1: 0.6994, Weighted-f1: 0.7846, Loss: 0.7420
[Epoch 3/50] Evaluation completed with Micro-f1: 0.4976, Macro-f1: 0.3414, Weighted-f1: 0.4562, Loss: 1.6100
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
Saved model with best loss 1.6100 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.8961, Macro-f1: 0.8209, Weighted-f1: 0.8867, Loss: 0.4564
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5082, Macro-f1: 0.3513, Weighted-f1: 0.4679, Loss: 1.6453
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9522, Macro-f1: 0.9171, Weighted-f1: 0.9476, Loss: 0.2972
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5181, Macro-f1: 0.3632, Weighted-f1: 0.4824, Loss: 1.5801
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
Saved model with best loss 1.5801 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9811, Macro-f1: 0.9642, Weighted-f1: 0.9804, Loss: 0.1774
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5257, Macro-f1: 0.3724, Weighted-f1: 0.4923, Loss: 1.6347
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9878, Macro-f1: 0.9780, Weighted-f1: 0.9874, Loss: 0.1202
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5305, Macro-f1: 0.3792, Weighted-f1: 0.4985, Loss: 1.6527
Saved models from epoch 7 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9950, Macro-f1: 0.9860, Weighted-f1: 0.9943, Loss: 0.0747
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5343, Macro-f1: 0.3835, Weighted-f1: 0.5033, Loss: 1.7308
Saved models from epoch 8 to 'data/predictions/almnps_4012/no_mapping/ood_validation/music/newest.pt'.
No improvement since 3 epochs (1.5801 loss). Early stop.
OOD training completed for test topic music after 8 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca198d610> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1a772b0> (dev).
Starting training on ['ai', 'literature', 'music', 'politics', 'science'] data with validation domain news.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3989, Macro-f1: 0.2562, Weighted-f1: 0.3409, Loss: 2.0539
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5048, Macro-f1: 0.3376, Weighted-f1: 0.4545, Loss: 1.6969
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
Saved model with best loss 1.6969 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7298, Macro-f1: 0.5854, Weighted-f1: 0.6994, Loss: 1.0088
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5348, Macro-f1: 0.3772, Weighted-f1: 0.4947, Loss: 1.4726
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
Saved model with best loss 1.4726 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8661, Macro-f1: 0.7799, Weighted-f1: 0.8532, Loss: 0.5593
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5528, Macro-f1: 0.3996, Weighted-f1: 0.5180, Loss: 1.4364
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
Saved model with best loss 1.4364 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9328, Macro-f1: 0.8845, Weighted-f1: 0.9284, Loss: 0.3209
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5633, Macro-f1: 0.4113, Weighted-f1: 0.5318, Loss: 1.4167
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
Saved model with best loss 1.4167 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9733, Macro-f1: 0.9454, Weighted-f1: 0.9693, Loss: 0.1861
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5721, Macro-f1: 0.4213, Weighted-f1: 0.5421, Loss: 1.4444
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9914, Macro-f1: 0.9845, Weighted-f1: 0.9916, Loss: 0.1093
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5798, Macro-f1: 0.4297, Weighted-f1: 0.5508, Loss: 1.4664
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9943, Macro-f1: 0.9898, Weighted-f1: 0.9939, Loss: 0.0724
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5852, Macro-f1: 0.4351, Weighted-f1: 0.5563, Loss: 1.5501
Saved models from epoch 7 to 'data/predictions/almnps_4012/no_mapping/ood_validation/news/newest.pt'.
No improvement since 3 epochs (1.4167 loss). Early stop.
OOD training completed for test topic news after 7 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8c84b37a60> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca1995c70> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'science'] data with validation domain politics.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.3622, Macro-f1: 0.2227, Weighted-f1: 0.3037, Loss: 2.1233
[Epoch 1/50] Evaluation completed with Micro-f1: 0.4869, Macro-f1: 0.3091, Weighted-f1: 0.4351, Loss: 1.7794
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.7794 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.6889, Macro-f1: 0.5440, Weighted-f1: 0.6538, Loss: 1.1607
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5260, Macro-f1: 0.3504, Weighted-f1: 0.4806, Loss: 1.4967
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.4967 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8308, Macro-f1: 0.7226, Weighted-f1: 0.8153, Loss: 0.6951
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5482, Macro-f1: 0.3770, Weighted-f1: 0.5073, Loss: 1.3723
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3723 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9071, Macro-f1: 0.8440, Weighted-f1: 0.9018, Loss: 0.4340
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5643, Macro-f1: 0.3937, Weighted-f1: 0.5255, Loss: 1.3474
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3474 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9549, Macro-f1: 0.9210, Weighted-f1: 0.9510, Loss: 0.2599
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5738, Macro-f1: 0.4054, Weighted-f1: 0.5376, Loss: 1.3417
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3417 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9758, Macro-f1: 0.9498, Weighted-f1: 0.9751, Loss: 0.1624
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5827, Macro-f1: 0.4150, Weighted-f1: 0.5484, Loss: 1.3380
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
Saved model with best loss 1.3380 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/best.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9904, Macro-f1: 0.9806, Weighted-f1: 0.9900, Loss: 0.1040
[Epoch 7/50] Evaluation completed with Micro-f1: 0.5885, Macro-f1: 0.4209, Weighted-f1: 0.5555, Loss: 1.4151
Saved models from epoch 7 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9944, Macro-f1: 0.9872, Weighted-f1: 0.9943, Loss: 0.0684
[Epoch 8/50] Evaluation completed with Micro-f1: 0.5940, Macro-f1: 0.4270, Weighted-f1: 0.5626, Loss: 1.3934
Saved models from epoch 8 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
[Epoch 9/50] Train completed with Micro-f1: 0.9972, Macro-f1: 0.9953, Weighted-f1: 0.9975, Loss: 0.0489
[Epoch 9/50] Evaluation completed with Micro-f1: 0.5973, Macro-f1: 0.4315, Weighted-f1: 0.5674, Loss: 1.4574
Saved models from epoch 9 to 'data/predictions/almnps_4012/no_mapping/ood_validation/politics/newest.pt'.
No improvement since 3 epochs (1.3380 loss). Early stop.
OOD training completed for test topic politics after 9 epochs.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8c849e1df0> (train).
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f8ca3a80760> (dev).
Starting training on ['ai', 'literature', 'music', 'news', 'politics'] data with validation domain science.
Read data from folder data/crossre_data/
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Using criterion: <LabelLoss: loss=XEnt>.
Optimizing using: AdamW with learning rate 2e-05.
[Epoch 1/50] Train completed with Micro-f1: 0.4119, Macro-f1: 0.2449, Weighted-f1: 0.3441, Loss: 2.0234
[Epoch 1/50] Evaluation completed with Micro-f1: 0.5477, Macro-f1: 0.3757, Weighted-f1: 0.5036, Loss: 1.6194
Saved models from epoch 1 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
Saved model with best loss 1.6194 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/best.pt'.
[Epoch 2/50] Train completed with Micro-f1: 0.7211, Macro-f1: 0.5712, Weighted-f1: 0.6871, Loss: 1.0379
[Epoch 2/50] Evaluation completed with Micro-f1: 0.5702, Macro-f1: 0.4021, Weighted-f1: 0.5291, Loss: 1.4204
Saved models from epoch 2 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
Saved model with best loss 1.4204 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/best.pt'.
[Epoch 3/50] Train completed with Micro-f1: 0.8459, Macro-f1: 0.7523, Weighted-f1: 0.8292, Loss: 0.6284
[Epoch 3/50] Evaluation completed with Micro-f1: 0.5807, Macro-f1: 0.4151, Weighted-f1: 0.5421, Loss: 1.4068
Saved models from epoch 3 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
Saved model with best loss 1.4068 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/best.pt'.
[Epoch 4/50] Train completed with Micro-f1: 0.9157, Macro-f1: 0.8446, Weighted-f1: 0.9082, Loss: 0.3836
[Epoch 4/50] Evaluation completed with Micro-f1: 0.5845, Macro-f1: 0.4242, Weighted-f1: 0.5514, Loss: 1.4079
Saved models from epoch 4 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
[Epoch 5/50] Train completed with Micro-f1: 0.9567, Macro-f1: 0.9230, Weighted-f1: 0.9526, Loss: 0.2365
[Epoch 5/50] Evaluation completed with Micro-f1: 0.5921, Macro-f1: 0.4317, Weighted-f1: 0.5614, Loss: 1.3916
Saved models from epoch 5 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
Saved model with best loss 1.3916 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/best.pt'.
[Epoch 6/50] Train completed with Micro-f1: 0.9797, Macro-f1: 0.9615, Weighted-f1: 0.9791, Loss: 0.1373
[Epoch 6/50] Evaluation completed with Micro-f1: 0.5977, Macro-f1: 0.4374, Weighted-f1: 0.5688, Loss: 1.4740
Saved models from epoch 6 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
[Epoch 7/50] Train completed with Micro-f1: 0.9881, Macro-f1: 0.9755, Weighted-f1: 0.9872, Loss: 0.0949
[Epoch 7/50] Evaluation completed with Micro-f1: 0.6017, Macro-f1: 0.4422, Weighted-f1: 0.5742, Loss: 1.5439
Saved models from epoch 7 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
[Epoch 8/50] Train completed with Micro-f1: 0.9979, Macro-f1: 0.9970, Weighted-f1: 0.9980, Loss: 0.0598
[Epoch 8/50] Evaluation completed with Micro-f1: 0.6054, Macro-f1: 0.4468, Weighted-f1: 0.5786, Loss: 1.5825
Saved models from epoch 8 to 'data/predictions/almnps_4012/no_mapping/ood_validation/science/newest.pt'.
No improvement since 3 epochs (1.3916 loss). Early stop.
OOD training completed for test topic science after 8 epochs.
TRAINING COMPLETED with:
	Domains:		['ai', 'literature', 'music', 'news', 'politics', 'science']
	OOD validaation:	True
	Mapping type:		None
