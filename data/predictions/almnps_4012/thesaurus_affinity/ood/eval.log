Loaded category mapping: thesaurus_affinity.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1cf3280df0> (test).
Starting prediction on ai test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/ai/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.3929, Macro-f1: 0.2762, Weighted-f1: 0.3481, Loss: 2.2031 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/ai/predictions.csv'.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1ce3fc6ee0> (test).
Starting prediction on literature test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/literature/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.5090, Macro-f1: 0.3523, Weighted-f1: 0.4668, Loss: 1.5237 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/literature/predictions.csv'.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1ce40546d0> (test).
Starting prediction on music test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/music/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.6737, Macro-f1: 0.4690, Weighted-f1: 0.6657, Loss: 1.2206 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/music/predictions.csv'.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1cf517ea00> (test).
Starting prediction on news test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/news/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.5673, Macro-f1: 0.2938, Weighted-f1: 0.5357, Loss: 1.5243 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/news/predictions.csv'.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1cf0d6e0a0> (test).
Starting prediction on politics test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/politics/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.5885, Macro-f1: 0.3097, Weighted-f1: 0.5508, Loss: 1.3337 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/politics/predictions.csv'.
Loaded <torch.utils.data.dataloader.DataLoader object at 0x7f1cf4fcc640> (test).
Starting prediction on science test data.
Loaded <TransformerEmbeddings: dim=768>.
Using classifier: <LinearClassifier: emb_model = <TransformerEmbeddings: dim=768>>
Loaded pre-trained classifier from 'data/predictions/almnps_4012/thesaurus_affinity/ood/science/best.pt'.
Using criterion: <LabelLoss: loss=XEnt>.
Prediction completed with Micro-f1: 0.4212, Macro-f1: 0.3067, Weighted-f1: 0.3950, Loss: 1.9654 (mean over batches).
Saved results from 'data/predictions/almnps_4012/thesaurus_affinity/ood/science/predictions.csv'.
All results saved. Exiting.
